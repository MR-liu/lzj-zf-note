
        <h2 id="t01. ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡">1. ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ <a href="#t01. ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡"> # </a></h2>
<ul>
<li>ä»¥ç±»å’Œå¯¹è±¡ä½œä¸ºç»„ç»‡ä»£ç çš„åŸºæœ¬å•ä½ï¼Œå¹¶å®ç°å°è£…ã€æŠ½è±¡ã€ç»§æ‰¿ã€å¤šæ€å››ä¸ªç‰¹æ€§</li>
<li>è½¯ä»¶å¼€å‘ç»å†åˆ†æã€è®¾è®¡å’Œç¼–ç ä¸‰ä¸ªé˜¶æ®µ<ul>
<li>é¢å‘å¯¹è±¡åˆ†æ(OOA) Object Oriented Analysis</li>
<li>é¢å‘å¯¹è±¡è®¾è®¡(OOD) Object Oriented Design</li>
<li>é¢å‘å¯¹è±¡ç¼–ç¨‹(OOP)Object Oriented Programming</li>
</ul>
</li>
</ul>
<h3 id="t11.1 æŠ½è±¡(Abstraction)">1.1 æŠ½è±¡(Abstraction) <a href="#t11.1 æŠ½è±¡(Abstraction)"> # </a></h3>
<ul>
<li>æŠ½è±¡ä¸»è¦æ˜¯éšè—æ–¹æ³•çš„å®ç°ï¼Œè®©è°ƒç”¨è€…åªå…³å¿ƒæœ‰å“ªäº›åŠŸèƒ½è€Œä¸æ˜¯å…³å¿ƒåŠŸèƒ½çš„å®ç°</li>
<li>æŠ½è±¡å¯ä»¥æé«˜ä»£ç çš„å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ï¼Œä¿®æ”¹å®ç°ä¸éœ€è¦æ”¹å˜å®šä¹‰ï¼Œå¯ä»¥å‡å°‘ä»£ç çš„æ”¹åŠ¨èŒƒå›´</li>
</ul>
<pre><code class="lang-js">interface IStorage {
    save(key: any, <span class="hljs-attr">value</span>: any): <span class="hljs-keyword">void</span>;
    read(key: any): <span class="hljs-keyword">void</span>;
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LocalStorage</span> <span class="hljs-title">implements</span> <span class="hljs-title">IStorage</span> </span>{
    save(key: any, <span class="hljs-attr">value</span>: any) {
        localStorage.setItem(key, value);
    }
    read(key: any) {
        <span class="hljs-keyword">return</span> localStorage.getItem(key);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string, public storage: IStorage) {

    }
    save() {
        <span class="hljs-keyword">this</span>.storage.save(<span class="hljs-string">'userInfo'</span>, <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>));
    }
    read() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.storage.read(<span class="hljs-string">'userInfo'</span>);
    }
}
<span class="hljs-keyword">let</span> user = <span class="hljs-keyword">new</span> User(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-keyword">new</span> LocalStorage());
user.save();
user.read();
</code></pre>
<h3 id="t21.2 ç»§æ‰¿">1.2 ç»§æ‰¿ <a href="#t21.2 ç»§æ‰¿"> # </a></h3>
<ul>
<li>ç»§æ‰¿ä¸»è¦çš„è¦å¤„æ˜¯å®ç°ä»£ç å¤ç”¨</li>
<li>ç»§æ‰¿å¯ä»¥æŠŠçˆ¶ç±»å’Œå­ç±»çš„å…¬å…±æ–¹æ³•æŠ½ç¦»å‡ºæ¥ï¼Œæé«˜å¤ç”¨ï¼Œå‡å°‘å†—ä½™</li>
<li>æ˜¯ä¸€ç§ <code>is-a</code> å…³ç³»</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> { };
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
    <span class="hljs-attr">name</span>: string;
    <span class="hljs-keyword">constructor</span>(name: string) {
        <span class="hljs-keyword">this</span>.name = name;
    }
    eat() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> eat`</span>)
    }
}
<span class="hljs-keyword">let</span> animal = <span class="hljs-keyword">new</span> Animal(<span class="hljs-string">'åŠ¨ç‰©'</span>);
animal.eat();

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
    <span class="hljs-attr">age</span>: number;
    <span class="hljs-keyword">constructor</span>(name: string, age: number) {
        <span class="hljs-keyword">super</span>(name);
        <span class="hljs-keyword">this</span>.age = age;
    }
    speak() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is barking!`</span>);
    }
}
<span class="hljs-keyword">let</span> dog = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">'ğŸ¶'</span>, <span class="hljs-number">5</span>);
dog.eat();
dog.speak();
</code></pre>
<blockquote>
<p>è¿‡åº¦ä½¿ç”¨ç»§æ‰¿æˆ–è€…è¯´ç»§æ‰¿å±‚æ¬¡è¿‡æ·±ä¼šå¯¼è‡´ä»£ç å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§å˜å·®
å­ç±»å’Œçˆ¶ç±»é«˜åº¦è€¦åˆï¼Œä¿®æ”¹çˆ¶ç±»çš„ä»£ç ï¼Œä¼šç›´æ¥å½±å“åˆ°å­ç±»</p>
</blockquote>
<h3 id="t31.3 å°è£…">1.3 å°è£… <a href="#t31.3 å°è£…"> # </a></h3>
<ul>
<li>æŠŠæ•°æ®å°è£…èµ·æ¥</li>
<li>å‡å°‘è€¦åˆï¼Œä¸è¯¥å¤–éƒ¨è®¿é—®çš„ä¸è¦è®©å¤–éƒ¨è®¿é—®</li>
<li>åˆ©äºæ•°æ®çš„æ¥å£æƒé™ç®¡ç†</li>
<li>ä»…æš´éœ²æœ‰é™çš„å¿…è¦æ¥å£ï¼Œæé«˜ç±»çš„æ˜“ç”¨æ€§</li>
<li>å®ç°<ul>
<li>public:å…¬æœ‰ä¿®é¥°ç¬¦ï¼Œå¯ä»¥åœ¨ç±»å†…æˆ–è€…ç±»å¤–ä½¿ç”¨publicä¿®é¥°çš„å±æ€§æˆ–è€…è¡Œä¸ºï¼Œé»˜è®¤ä¿®é¥°ç¬¦</li>
<li>protected:å—ä¿æŠ¤çš„ä¿®é¥°ç¬¦ï¼Œå¯ä»¥æœ¬ç±»å’Œå­ç±»ä¸­ä½¿ç”¨protectedä¿®é¥°çš„å±æ€§å’Œè¡Œä¸º</li>
<li>private : ç§æœ‰ä¿®é¥°ç¬¦ï¼Œåªå¯ä»¥åœ¨ç±»å†…ä½¿ç”¨privateä¿®é¥°çš„å±æ€§å’Œè¡Œä¸º</li>
</ul>
</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/1control.png" alt="1control">
<img src="http://img.zhufengpeixun.cn/2control.png" alt="2control"></p>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
    public name: string;
    protected age: number;
    private weight: number;
    <span class="hljs-keyword">constructor</span>(name: string, age: number, weight: number) {
        <span class="hljs-keyword">this</span>.name = name;
        <span class="hljs-keyword">this</span>.age = age;
        <span class="hljs-keyword">this</span>.weight = weight;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
    private money: number;
    <span class="hljs-keyword">constructor</span>(name: string, age: number, weight: number, money: number) {
        <span class="hljs-keyword">super</span>(name, age, weight);
        <span class="hljs-keyword">this</span>.money = money;
    }
    getName() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.name);
    }
    getAge() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.age);
    }
    getWeight() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.weight);
    }
    getMoney() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.money);
    }
}
<span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">'zfpx'</span>, <span class="hljs-number">9</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);
<span class="hljs-built_in">console</span>.log(p.name);
<span class="hljs-built_in">console</span>.log(p.age);
<span class="hljs-built_in">console</span>.log(p.weight);
</code></pre>
<h3 id="t41.4 å¤šæ€">1.4 å¤šæ€ <a href="#t41.4 å¤šæ€"> # </a></h3>
<ul>
<li>å¤šæ€æ˜¯æŒ‡ï¼Œå­ç±»å¯ä»¥æ›¿æ¢çˆ¶ç±»</li>
<li>ä¿æŒå­ç±»çš„å¼€æ”¾æ€§å’Œçµæ´»æ€§ï¼Œå¯ä»¥é‡å†™çˆ¶ç±»ä¸­çš„æ–¹æ³•</li>
<li>å®ç°é¢å‘æ¥å£ç¼–ç¨‹  </li>
</ul>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
    public name: string;
    protected age: number;
    private weight: number;
    <span class="hljs-keyword">constructor</span>(name: string, age: number, weight: number) {
        <span class="hljs-keyword">this</span>.name = name;
        <span class="hljs-keyword">this</span>.age = age;
        <span class="hljs-keyword">this</span>.weight = weight;
    }
    speak() {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'æ­¤æ–¹æ³•å¿…é¡»ç”±å­ç±»å®ç°!'</span>);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
    private money: number;
    <span class="hljs-keyword">constructor</span>(name: string, age: number, weight: number, money: number) {
        <span class="hljs-keyword">super</span>(name, age, weight);
        <span class="hljs-keyword">this</span>.money = money;
    }
    getName() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.name);
    }
    getAge() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.age);
    }
    getMoney() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.money);
    }
    speak() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ä½ å¥½!'</span>);
    }

}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
    <span class="hljs-keyword">constructor</span>(name: string, age: number, weight: number) {
        <span class="hljs-keyword">super</span>(name, age, weight);
    }
    speak() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æ±ªæ±ªæ±ª!'</span>);
    }
}
<span class="hljs-keyword">let</span> p = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">'zfpx'</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);
p.speak();
<span class="hljs-keyword">let</span> d = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">'zfpx'</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);
d.speak();
</code></pre>
<h2 id="t52. è®¾è®¡åŸåˆ™">2. è®¾è®¡åŸåˆ™ <a href="#t52. è®¾è®¡åŸåˆ™"> # </a></h2>
<h3 id="t62.1 ä»€ä¹ˆæ˜¯è®¾è®¡ï¼Ÿ">2.1 ä»€ä¹ˆæ˜¯è®¾è®¡ï¼Ÿ <a href="#t62.1 ä»€ä¹ˆæ˜¯è®¾è®¡ï¼Ÿ"> # </a></h3>
<ul>
<li>æŒ‰å“ªä¸€ç§æ€è·¯æˆ–è€…æ ‡å‡†æ¥å®ç°åŠŸèƒ½</li>
<li>åŠŸèƒ½ç›¸åŒï¼Œå¯ä»¥æœ‰ä¸åŒè®¾è®¡çš„æ–¹å¼</li>
<li>éœ€æ±‚å¦‚æœä¸æ–­å˜åŒ–ï¼Œè®¾è®¡çš„ä½œç”¨æ‰èƒ½ä½“ç°å‡ºæ¥</li>
</ul>
<h3 id="t72.2 SOLIDäº”å¤§è®¾è®¡åŸåˆ™">2.2 SOLIDäº”å¤§è®¾è®¡åŸåˆ™ <a href="#t72.2 SOLIDäº”å¤§è®¾è®¡åŸåˆ™"> # </a></h3>
<table>
<thead>
<tr>
<th style="text-align:left">é¦–å­—æ¯</th>
<th style="text-align:left">æŒ‡ä»£</th>
<th style="text-align:left">æ¦‚å¿µ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">S</td>
<td style="text-align:left">å•ä¸€èŒè´£åŸåˆ™</td>
<td style="text-align:left">å•ä¸€åŠŸèƒ½åŸåˆ™è®¤ä¸ºå¯¹è±¡åº”è¯¥ä»…å…·æœ‰ä¸€ç§<code>å•ä¸€åŠŸèƒ½</code>çš„æ¦‚å¿µ</td>
</tr>
<tr>
<td style="text-align:left">O</td>
<td style="text-align:left">å¼€æ”¾å°é—­åŸåˆ™</td>
<td style="text-align:left">å¼€é—­åŸåˆ™è®¤ä¸º<code>è½¯ä»¶ä½“åº”è¯¥æ˜¯å¯¹äºæ‰©å±•å¼€æ”¾çš„ï¼Œä½†æ˜¯å¯¹äºä¿®æ”¹å°é—­çš„</code>çš„æ¦‚å¿µ</td>
</tr>
<tr>
<td style="text-align:left">L</td>
<td style="text-align:left">é‡Œæ°æ›¿æ¢åŸåˆ™</td>
<td style="text-align:left">é‡Œæ°æ›¿æ¢åŸåˆ™è®¤ä¸ºç¨‹åºä¸­çš„å¯¹è±¡åº”è¯¥æ˜¯å¯ä»¥åœ¨ä¸æ”¹å˜ç¨‹åºæ­£ç¡®æ€§çš„å‰æä¸‹<code>è¢«å®ƒçš„å­ç±»æ‰€æ›¿æ¢</code>çš„çš„æ¦‚å¿µ</td>
</tr>
<tr>
<td style="text-align:left">I</td>
<td style="text-align:left">æ¥å£éš”ç¦»åŸåˆ™</td>
<td style="text-align:left">æ¥å£éš”ç¦»åŸåˆ™è®¤ä¸º<code>å¤šä¸ªç‰¹å®šå®¢æˆ·ç«¯æ¥å£è¦å¥½äºä¸€ä¸ªå®½æ³›ç”¨é€”çš„æ¥å£</code>çš„æ¦‚å¿µ</td>
</tr>
<tr>
<td style="text-align:left">D</td>
<td style="text-align:left">ä¾èµ–åè½¬åŸåˆ™</td>
<td style="text-align:left">ä¾èµ–åè½¬åŸåˆ™è®¤ä¸ºä¸€ä¸ªæ–¹æ³•åº”è¯¥éµä»<code>ä¾èµ–äºæŠ½è±¡è€Œä¸æ˜¯ä¸€ä¸ªå®ä¾‹</code>çš„æ¦‚å¿µ,ä¾èµ–æ³¨å…¥æ˜¯è¯¥åŸåˆ™çš„ä¸€ç§å®ç°æ–¹å¼ã€‚</td>
</tr>
</tbody>
</table>
<h4 id="t82.2.1 O å¼€æ”¾å°é—­åŸåˆ™">2.2.1 O å¼€æ”¾å°é—­åŸåˆ™ <a href="#t82.2.1 O å¼€æ”¾å°é—­åŸåˆ™"> # </a></h4>
<ul>
<li><code>Open Closed Principle</code></li>
<li>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</li>
<li>å¢åŠ éœ€æ±‚æ—¶ï¼Œæ‰©å±•æ–°ä»£ç ï¼Œè€Œéä¿®æ”¹å·²æœ‰ä»£ç </li>
<li>å¼€é—­åŸåˆ™æ˜¯è®¾è®¡æ¨¡å¼ä¸­çš„æ€»åŸåˆ™</li>
<li>å¯¹è¿‘æœŸå¯èƒ½ä¼šå˜åŒ–å¹¶ä¸”å¦‚æœæœ‰å˜åŒ–ä½†æ”¹åŠ¨é‡å·¨å¤§çš„åœ°æ–¹è¦å¢åŠ æ‰©å±•ç‚¹,æ‰©å±•ç‚¹è¿‡å¤šä¼šé™ä½å¯è¯»æ€§</li>
</ul>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span> </span>{
    <span class="hljs-keyword">constructor</span>(public rank: string) { }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Product</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string, public price: number) {

    }
    cost(customer: Customer) {
        <span class="hljs-keyword">switch</span> (customer.rank) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'member'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.price * <span class="hljs-number">.8</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">'vip'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.price * <span class="hljs-number">.6</span>;
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.price;
        }
    }
}
<span class="hljs-keyword">let</span> p1 = <span class="hljs-keyword">new</span> Product(<span class="hljs-string">'ç¬”è®°æœ¬ç”µè„‘'</span>, <span class="hljs-number">1000</span>);
<span class="hljs-keyword">let</span> member = <span class="hljs-keyword">new</span> Customer(<span class="hljs-string">'member'</span>);
<span class="hljs-keyword">let</span> vip = <span class="hljs-keyword">new</span> Customer(<span class="hljs-string">'vip'</span>);
<span class="hljs-keyword">let</span> guest = <span class="hljs-keyword">new</span> Customer(<span class="hljs-string">'guest'</span>);
<span class="hljs-built_in">console</span>.log(p1.cost(member));
<span class="hljs-built_in">console</span>.log(p1.cost(vip));
<span class="hljs-built_in">console</span>.log(p1.cost(guest));
</code></pre>
<pre><code class="lang-diff">class Customer {
<span class="hljs-addition">+    constructor(public rank: string, public discount: number = 1) { }</span>
<span class="hljs-addition">+    getDiscount() {</span>
<span class="hljs-addition">+        return this.discount;</span>
<span class="hljs-addition">+    }</span>
}
class Product {
    constructor(public name: string, public price: number) {

    }
    cost(customer: Customer) {
<span class="hljs-deletion">-        /*  switch (customer.rank) {</span>
<span class="hljs-deletion">-             case 'member':</span>
<span class="hljs-deletion">-                 return this.price * .8;</span>
<span class="hljs-deletion">-             case 'vip':</span>
<span class="hljs-deletion">-                 return this.price * .6;</span>
<span class="hljs-deletion">-             default:</span>
<span class="hljs-deletion">-                 return this.price;</span>
<span class="hljs-deletion">-         } */</span>
<span class="hljs-addition">+        return this.price * customer.getDiscount();</span>
    }
}
<span class="hljs-addition">+let p1 = new Product('ç¬”è®°æœ¬ç”µè„‘', 1000);</span>
<span class="hljs-addition">+let member = new Customer('member', .8);</span>
<span class="hljs-addition">+let vip = new Customer('vip', .6);</span>
let guest = new Customer('guest');
console.log(p1.cost(member));
console.log(p1.cost(vip));
console.log(p1.cost(guest));
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> axios, { AxiosInstance, AxiosRequestConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;
<span class="hljs-keyword">let</span> instance: AxiosInstance = axios.create();
instance.interceptors.request.use(<span class="hljs-function">(<span class="hljs-params">config: AxiosRequestConfig</span>) =&gt;</span> {
    config.url = <span class="hljs-string">'http://localhost:8080'</span> + config.url;
    <span class="hljs-keyword">return</span> config;
});

instance.interceptors.response.use(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (response.status !== <span class="hljs-number">200</span> || response.data.code != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject(response);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> response.data.data;
    }
})
<span class="hljs-comment">/**
 * {code:0,data:{id:1,name:'zhufeng'}}
 */</span>
instance({
    <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/users'</span>
}).then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(result);
}, error =&gt; {
    <span class="hljs-built_in">console</span>.error(error);
});
</code></pre>
<h4 id="t92.2.2 S å•ä¸€èŒè´£åŸåˆ™">2.2.2 S å•ä¸€èŒè´£åŸåˆ™ <a href="#t92.2.2 S å•ä¸€èŒè´£åŸåˆ™"> # </a></h4>
<ul>
<li>Single responsibility principle</li>
<li>ä¸€ä¸ªç±»æˆ–è€…æ¨¡å—åªè´Ÿè´£å®Œæˆä¸€ä¸ªèŒè´£,å¦‚æœåŠŸèƒ½ç‰¹åˆ«å¤æ‚å°±è¿›è¡Œæ‹†åˆ†</li>
<li>å•ä¸€èŒè´£å¯ä»¥é™ä½ç±»çš„å¤æ‚æ€§ï¼Œæé«˜ä»£ç å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§</li>
<li>å½“ç±»ä»£ç è¡Œæ•°è¿‡å¤šã€æ–¹æ³•è¿‡å¤šã€åŠŸèƒ½å¤ªå¤šã€èŒè´£å¤ªæ‚çš„æ—¶å€™å°±è¦å¯¹ç±»è¿›è¡Œæ‹†åˆ†äº†</li>
<li><p>æ‹†åˆ†ä¸èƒ½è¿‡åº¦ï¼Œå¦‚æœæ‹†åˆ†è¿‡åº¦ä¼šæŸå¤±å†…èšæ€§å’Œç»´æŠ¤æ€§</p>
</li>
<li><p><a href="https://www.lodashjs.com/docs/latest">lodashjs</a></p>
</li>
<li><a href="https://api.jquery.com/">jquery</a></li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/product.png" alt="product"></p>
<pre><code class="lang-diff">class Product {
    public name: string;
<span class="hljs-deletion">-    public categoryName: string;</span>
<span class="hljs-deletion">-    public categoryIcon: string;</span>
<span class="hljs-addition">+     public category:Category;</span>
}
<span class="hljs-addition">+class Category {</span>
<span class="hljs-addition">+    public name: string;</span>
<span class="hljs-addition">+    public icon: string;</span>
<span class="hljs-addition">+}</span>
</code></pre>
<h4 id="t102.2.3 L é‡Œæ°æ›¿æ¢åŸåˆ™">2.2.3 L é‡Œæ°æ›¿æ¢åŸåˆ™ <a href="#t102.2.3 L é‡Œæ°æ›¿æ¢åŸåˆ™"> # </a></h4>
<ul>
<li>Liskov Substitution Principle</li>
<li>æ‰€æœ‰å¼•ç”¨åŸºç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡</li>
<li>å­ç±»èƒ½æ›¿æ¢æ‰çˆ¶ç±»ï¼Œä½¿ç”¨è€…å¯èƒ½æ ¹æœ¬å°±ä¸éœ€è¦çŸ¥é“æ˜¯çˆ¶ç±»è¿˜æ˜¯å­ç±»,åä¹‹åˆ™ä¸è¡Œ</li>
<li>é‡Œæ°æ›¿æ¢åŸåˆ™æ˜¯å¼€é—­åŸåˆ™çš„å®ç°åŸºç¡€,ç¨‹åºè®¾è®¡çš„æ—¶å€™å°½é‡ä½¿ç”¨åŸºç±»å®šä¹‰åŠå¼•ç”¨ï¼Œè¿è¡Œæ—¶å†å†³å®šä½¿ç”¨å“ªä¸ªå­ç±»</li>
<li>é‡Œæ°æ›¿æ¢åŸåˆ™å¯ä»¥æé«˜ä»£ç çš„å¤ç”¨æ€§ï¼Œæé«˜ä»£ç çš„å¯æ‰©å±•æ€§ï¼Œä¹Ÿå¢åŠ äº†è€¦åˆæ€§</li>
<li>ç›¸å¯¹äºå¤šæ€ï¼Œè¿™ä¸ªåŸåˆ™æ˜¯è®²çš„æ˜¯ç±»å¦‚ä½•è®¾è®¡ï¼Œå­ç±»å¦‚æœè¿åäº†çˆ¶ç±»çš„åŠŸèƒ½åˆ™è¡¨ç¤ºè¿åäº†é‡Œæ°æ›¿æ¢åŸåˆ™</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/3.Substitution.png" alt="Substitution"></p>
<pre><code class="lang-js">abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractDrink</span> </span>{
    abstract getName(): string;
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CocaCola</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractDrink</span> </span>{
    getName(): string {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'å¯ä¹'</span>;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sprite</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractDrink</span> </span>{
    getName(): string {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'é›ªç¢§'</span>;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Fanta</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractDrink</span> </span>{
    getName(): string {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'èŠ¬è¾¾'</span>;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span> </span>{
    drink(drink: AbstractDrink) {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'å–'</span> + drink.getName());
    }
}
<span class="hljs-keyword">let</span> customer = <span class="hljs-keyword">new</span> Customer();
<span class="hljs-keyword">let</span> cocaCola = <span class="hljs-keyword">new</span> CocaCola();
<span class="hljs-keyword">let</span> sprite = <span class="hljs-keyword">new</span> Sprite();
<span class="hljs-keyword">let</span> fanta = <span class="hljs-keyword">new</span> Fanta();
customer.drink(cocaCola);
customer.drink(sprite);
customer.drink(fanta);
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
    render() {
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>App <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        )
    }
}
<span class="hljs-keyword">let</span> element = React.createElement(App);
ReactDOM.render(element, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>));
</code></pre>
<pre><code class="lang-js">abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractDrink</span> </span>{
    abstract getName(): any;
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CocaCola</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractDrink</span> </span>{
    getName(): any {
        <span class="hljs-keyword">return</span> <span class="hljs-number">100</span>;
    }
}
</code></pre>
<h4 id="t112.2.4 D ä¾èµ–å€’ç½®åŸåˆ™">2.2.4 D ä¾èµ–å€’ç½®åŸåˆ™ <a href="#t112.2.4 D ä¾èµ–å€’ç½®åŸåˆ™"> # </a></h4>
<ul>
<li>Dependence Inversion Principle</li>
<li>é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¾èµ–äºæŠ½è±¡è€Œä¸ä¾èµ–äºå…·ä½“å®ç°</li>
<li>è¦æ±‚æˆ‘ä»¬åœ¨ç¨‹åºä»£ç ä¸­ä¼ é€’å‚æ•°æ—¶æˆ–åœ¨å…³è”å…³ç³»ä¸­ï¼Œå°½é‡å¼•ç”¨å±‚æ¬¡é«˜çš„æŠ½è±¡å±‚ç±»</li>
<li>ä½¿ç”¨æ–¹åªå…³æ³¨æ¥å£è€Œä¸å…³æ³¨å…·ä½“ç±»çš„å®ç°</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/5.Inversion.png" alt="Inversion"></p>
<pre><code class="lang-js">abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GirlFriend</span> </span>{
    public age: number;
    public height: number;
    public abstract cook(): <span class="hljs-keyword">void</span>;
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LinZhiLing</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">GirlFriend</span> </span>{
    public cook(): <span class="hljs-keyword">void</span> {

    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HanMeiMei</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">GirlFriend</span> </span>{
    public cook(): <span class="hljs-keyword">void</span> {

    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SingleDog</span> </span>{
    <span class="hljs-keyword">constructor</span>(public girlFriend: GirlFriend) {

    }
}
<span class="hljs-keyword">let</span> s1 = <span class="hljs-keyword">new</span> SingleDog(<span class="hljs-keyword">new</span> LinZhiLing());
<span class="hljs-keyword">let</span> s2 = <span class="hljs-keyword">new</span> SingleDog(<span class="hljs-keyword">new</span> HanMeiMei());
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { createStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">let</span> store = createStore(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state);
<span class="hljs-keyword">export</span> interface Action&lt;T = any&gt; {
    <span class="hljs-attr">type</span>: T
}
<span class="hljs-keyword">export</span> interface AnyAction extends Action {
    <span class="hljs-comment">// Allows any extra properties to be defined in an action.</span>
    [extraProps: string]: any
}
<span class="hljs-keyword">let</span> action: AnyAction = { <span class="hljs-attr">type</span>: <span class="hljs-string">'increment'</span>, <span class="hljs-attr">payload</span>: <span class="hljs-number">5</span> }
store.dispatch(action);
</code></pre>
<h4 id="t122.2.5  I æ¥å£éš”ç¦»åŸåˆ™">2.2.5  I æ¥å£éš”ç¦»åŸåˆ™ <a href="#t122.2.5  I æ¥å£éš”ç¦»åŸåˆ™"> # </a></h4>
<ul>
<li>Interface Segregation Principle</li>
<li>ä¿æŒæ¥å£çš„å•ä¸€ç‹¬ç«‹ï¼Œé¿å…å‡ºç°èƒ–æ¥å£</li>
<li>å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ï¼Œç±»é—´çš„ä¾èµ–å…³ç³»åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Š</li>
<li>æ¥å£å°½é‡ç»†åŒ–ï¼Œè€Œä¸”æ¥å£ä¸­çš„æ–¹æ³•å°½é‡çš„å°‘</li>
<li>ç±»ä¼¼äºå•ä¸€èŒè´£åŸåˆ™ï¼Œæ›´å…³æ³¨æ¥å£</li>
</ul>
<pre><code class="lang-js">interface IUserManager {
    updateUserInfo(): <span class="hljs-keyword">void</span>;
    updatePassword(): <span class="hljs-keyword">void</span>;
}
interface IProductManager {
    updateProduct(): <span class="hljs-keyword">void</span>;
    updatePrice(): <span class="hljs-keyword">void</span>;
}
</code></pre>
<p><img src="http://img.zhufengpeixun.cn/play.jpg" alt="play"></p>
<pre><code class="lang-js">interface Running {
    run(): <span class="hljs-keyword">void</span>;
}
interface Flying {
    fly(): <span class="hljs-keyword">void</span>;
}
interface Swimming {
    swim(): <span class="hljs-keyword">void</span>;
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Automobile</span> <span class="hljs-title">implements</span> <span class="hljs-title">Running</span>, <span class="hljs-title">Flying</span>, <span class="hljs-title">Swimming</span> </span>{
    run() { }
    fly() { }
    swim() { }
}
</code></pre>
<h3 id="t132.3  è¿ªç±³ç‰¹æ³•åˆ™">2.3  è¿ªç±³ç‰¹æ³•åˆ™ <a href="#t132.3  è¿ªç±³ç‰¹æ³•åˆ™"> # </a></h3>
<ul>
<li>Law of Demeterï¼ŒLOD</li>
<li>æœ‰æ—¶å€™ä¹Ÿå«åšæœ€å°‘çŸ¥è¯†åŸåˆ™</li>
<li>ä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å°½å¯èƒ½å°‘åœ°ä¸å…¶å®ƒå®ä½“å‘ç”Ÿç›¸äº’ä½œç”¨</li>
<li>è¿ªç±³ç‰¹æ³•åˆ™çš„åˆè¡·åœ¨äºé™ä½ç±»ä¹‹é—´çš„è€¦åˆ</li>
<li>ç±»å®šä¹‰æ—¶å°½é‡è¦å®ç°å†…èš,å°‘ä½¿ç”¨<code>public</code>ä¿®é¥°ç¬¦ï¼Œå°½é‡ä½¿ç”¨<code>private</code>ã€<code>protected</code> ç­‰</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/6.Demeter.png" alt="Demeter"></p>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Salesman</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string) {

    }
    sale() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.name + <span class="hljs-string">' é”€å”®ä¸­....'</span>);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SaleManager</span> </span>{
    private salesmen: <span class="hljs-built_in">Array</span>&lt;Salesman&gt; = [<span class="hljs-keyword">new</span> Salesman(<span class="hljs-string">'å¼ ä¸‰'</span>), <span class="hljs-keyword">new</span> Salesman(<span class="hljs-string">'æå››'</span>)];
    sale() {
        <span class="hljs-keyword">this</span>.salesmen.forEach(<span class="hljs-function"><span class="hljs-params">salesman</span> =&gt;</span> salesman.sale());
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CEO</span> </span>{
    private saleManager: SaleManager = <span class="hljs-keyword">new</span> SaleManager();
    sale() {
        <span class="hljs-keyword">this</span>.saleManager.sale();
    }
}
<span class="hljs-keyword">let</span> ceo = <span class="hljs-keyword">new</span> CEO();
ceo.sale();
</code></pre>
<h3 id="t142.4  åˆæˆå¤ç”¨åŸåˆ™">2.4  åˆæˆå¤ç”¨åŸåˆ™ <a href="#t142.4  åˆæˆå¤ç”¨åŸåˆ™"> # </a></h3>
<h4 id="t152.4.1 ç±»çš„å…³ç³»">2.4.1 ç±»çš„å…³ç³» <a href="#t152.4.1 ç±»çš„å…³ç³»"> # </a></h4>
<ul>
<li>ç±»ä¹‹é—´æœ‰ä¸‰ç§åŸºæœ¬å…³ç³»ï¼Œåˆ†åˆ«æ˜¯å…³è”(èšåˆå’Œç»„åˆ)ã€æ³›åŒ–å’Œä¾èµ–</li>
<li>å¦‚æœä¸€ä¸ªç±»å•å‘ä¾èµ–å¦ä¸€ä¸ªç±»,é‚£ä¹ˆå®ƒä»¬ä¹‹é—´å°±æ˜¯å•å‘å…³è”ã€‚å¦‚æœå½¼æ­¤ä¾èµ–,åˆ™ä¸ºç›¸äº’ä¾èµ–,å³åŒå‘å…³è”</li>
<li>å…³è”å…³ç³»åŒ…æ‹¬ä¸¤ç§ç‰¹ä¾‹ï¼šèšåˆå’Œç»„åˆ<ul>
<li>èšåˆï¼Œç”¨æ¥è¡¨ç¤ºæ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»æˆ–è€…<code>æ‹¥æœ‰</code>å…³ç³»,ä»£è¡¨éƒ¨åˆ†çš„å¯¹è±¡å¯èƒ½ä¼šè¢«æ•´ä½“æ‹¥æœ‰ï¼Œä½†å¹¶ä¸å®šå®šä¼šéšç€æ•´ä½“çš„æ¶ˆäº¡è€Œé”€æ¯,æ¯”å¦‚ç­çº§å’Œå­¦ç”Ÿ</li>
<li>åˆæˆæˆ–è€…è¯´ç»„åˆè¦æ¯”èšåˆå…³ç³»å¼ºçš„å¤šï¼Œéƒ¨åˆ†å’Œæ•´ä½“çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸€è‡´çš„,æ¯”å¦‚äººå’Œå™¨å®˜ä¹‹é—´</li>
</ul>
</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/xinyuanjieyi.png" alt="xinyuanjieyi"></p>
<p><img src="http://img.zhufengpeixun.cn/7.composite.png" alt="composite"></p>
<h4 id="t162.4.2 åˆæˆå¤ç”¨åŸåˆ™">2.4.2 åˆæˆå¤ç”¨åŸåˆ™ <a href="#t162.4.2 åˆæˆå¤ç”¨åŸåˆ™"> # </a></h4>
<ul>
<li>åˆæˆå¤ç”¨åŸåˆ™æ˜¯é€šè¿‡å°†å·²æœ‰çš„å¯¹è±¡çº³å…¥æ–°å¯¹è±¡ä¸­ï¼Œä½œä¸ºæ–°å¯¹è±¡çš„æˆå‘˜å¯¹è±¡æ¥å®ç°çš„</li>
<li>æ–°å¯¹è±¡å¯ä»¥è°ƒç”¨å·²æœ‰å¯¹è±¡çš„åŠŸèƒ½ï¼Œä»è€Œè¾¾åˆ°å¤ç”¨</li>
<li>åŸåˆ™æ˜¯å°½é‡é¦–å…ˆä½¿ç”¨ç»„åˆ/èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿</li>
<li>ä¸“ä¸šäººåšä¸“ä¸šäº‹</li>
</ul>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cooker</span> </span>{
    cook() {

    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{
    private cooker: Cooker = <span class="hljs-keyword">new</span> Cooker();
    cook() {
        <span class="hljs-keyword">this</span>.cooker.cook();
    }
}
</code></pre>
<h3 id="t172.5 æ€»ç»“">2.5 æ€»ç»“ <a href="#t172.5 æ€»ç»“"> # </a></h3>
<ul>
<li>å¼€é—­åŸåˆ™æ˜¯æ ¸å¿ƒï¼Œå¯¹ä¿®æ”¹å…³é—­å¯¹æ‰©å±•å¼€æ”¾æ˜¯è½¯ä»¶è®¾è®¡çš„åŸºçŸ³</li>
<li>å•ä¸€èŒè´£è¦æ±‚æˆ‘ä»¬è®¾è®¡æ¥å£å’Œæ¨¡å—åŠŸèƒ½çš„æ—¶å€™å°½é‡ä¿è¯å•ä¸€æ€§å’ŒåŸå­æ€§ï¼Œä¿®æ”¹ä¸€æ¡ä¸å½±å“å…¨å±€å’Œå…¶å®ƒæ¨¡å—</li>
<li>é‡Œæ°æ›¿æ¢åŸåˆ™å’Œä¾èµ–å€’ç½®åŸåˆ™è¦æ±‚é¢å‘æ¥å£å’ŒæŠ½è±¡ç¼–ç¨‹,ä¸è¦ä¾èµ–å…·ä½“å®ç°ï¼Œå¦åˆ™å®ç°ä¸€æ”¹ï¼Œä¸Šå±‚è°ƒç”¨è€…å°±è¦å¯¹åº”ä¿®æ”¹</li>
</ul>
<h3 id="t182.6 å¦‚ä½•å†™å‡ºå¥½ä»£ç ?">2.6 å¦‚ä½•å†™å‡ºå¥½ä»£ç ? <a href="#t182.6 å¦‚ä½•å†™å‡ºå¥½ä»£ç ?"> # </a></h3>
<ul>
<li>å¯ç»´æŠ¤æ€§ BUGæ˜¯å¦å¥½æ”¹?</li>
<li>å¯è¯»æ€§ æ˜¯å¦å®¹æ˜“çœ‹æ‡‚?</li>
<li>å¯æ‰©å±•æ€§ æ˜¯å¦å¯ä»¥æ·»åŠ æ–°åŠŸèƒ½?</li>
<li>çµæ´»æ€§ æ·»åŠ æ–°åŠŸèƒ½æ˜¯å¦å®¹æ˜“?è€æ–¹æ³•å’Œæ¥å£æ˜¯å¦å®¹æ˜“å¤ç”¨?</li>
<li>ç®€æ´æ€§ ä»£ç æ˜¯å¦ç®€å•æ¸…æ™°?</li>
<li>å¯å¤ç”¨æ€§ ç›¸åŒçš„ä»£ç ä¸è¦å†™2é?</li>
<li>å¯æµ‹è¯•æ€§ æ˜¯å¦æ–¹ä¾¿å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•?</li>
</ul>
<h2 id="t193. 23ç§è®¾è®¡æ¨¡å¼">3. 23ç§è®¾è®¡æ¨¡å¼ <a href="#t193. 23ç§è®¾è®¡æ¨¡å¼"> # </a></h2>
<h3 id="t203.1 åˆ›å»ºå‹">3.1 åˆ›å»ºå‹ <a href="#t203.1 åˆ›å»ºå‹"> # </a></h3>
<ul>
<li><code>é‡è¦: å·¥å‚æ¨¡å¼(å·¥å‚æ–¹æ³•æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€ç®€å•å·¥å‚æ¨¡å¼)ã€å»ºé€ è€…æ¨¡å¼ã€å•ä¾‹æ¨¡å¼</code></li>
<li>ä¸é‡è¦: åŸå‹æ¨¡å¼</li>
</ul>
<h3 id="t213.2 ç»“æ„å‹æ¨¡å¼">3.2 ç»“æ„å‹æ¨¡å¼ <a href="#t213.2 ç»“æ„å‹æ¨¡å¼"> # </a></h3>
<ul>
<li><code>é‡è¦: ä»£ç†æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼</code></li>
<li>ä¸é‡è¦: å¤–è§‚æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€äº«å…ƒæ¨¡å¼</li>
</ul>
<h3 id="t223.3 è¡Œä¸ºå‹">3.3 è¡Œä¸ºå‹ <a href="#t223.3 è¡Œä¸ºå‹"> # </a></h3>
<ul>
<li><code>é‡è¦: è§‚å¯Ÿè€…æ¨¡å¼ã€æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€èŒè´£é“¾æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼</code></li>
<li>ä¸é‡è¦: è®¿é—®è€…æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼</li>
</ul>
<h2 id="t234. å·¥å‚æ¨¡å¼">4. å·¥å‚æ¨¡å¼ <a href="#t234. å·¥å‚æ¨¡å¼"> # </a></h2>
<h3 id="t244.1 ç®€å•å·¥å‚æ¨¡å¼">4.1 ç®€å•å·¥å‚æ¨¡å¼ <a href="#t244.1 ç®€å•å·¥å‚æ¨¡å¼"> # </a></h3>
<ul>
<li>ç®€å•å·¥å‚æ¨¡å¼æ˜¯ç”±ä¸€ä¸ªå·¥å‚å¯¹è±¡å†³å®šåˆ›å»ºå‡ºå“ªä¸€ç§äº§å“ç±»çš„å®ä¾‹<h4 id="t254.1.1 ç±»å›¾">4.1.1 ç±»å›¾ <a href="#t254.1.1 ç±»å›¾"> # </a></h4>
</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/simplefatory2.png" alt="simplefatory2"></p>
<h4 id="t264.1.2 ä»£ç ">4.1.2 ä»£ç  <a href="#t264.1.2 ä»£ç "> # </a></h4>
<pre><code class="lang-js">abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Coffee</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string) {

    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AmericanoCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coffee</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string) {
        <span class="hljs-keyword">super</span>(name);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LatteCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coffee</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string) {
        <span class="hljs-keyword">super</span>(name);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CappuccinoCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coffee</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string) {
        <span class="hljs-keyword">super</span>(name);
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Caf</span>Ã© </span>{
    <span class="hljs-keyword">static</span> order(name: string) {
        <span class="hljs-keyword">switch</span> (name) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'Americano'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AmericanoCoffee(<span class="hljs-string">'ç¾å¼å’–å•¡'</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">'Latte'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> LatteCoffee(<span class="hljs-string">'æ‹¿é“å’–å•¡'</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">'Cappuccino'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> LatteCoffee(<span class="hljs-string">'å¡å¸ƒå¥‡è¯º'</span>);
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }
}
<span class="hljs-built_in">console</span>.log(CafÃ©.order(<span class="hljs-string">'Americano'</span>));
<span class="hljs-built_in">console</span>.log(CafÃ©.order(<span class="hljs-string">'Latte'</span>));
<span class="hljs-built_in">console</span>.log(CafÃ©.order(<span class="hljs-string">'Cappuccino'</span>));

</code></pre>
<h3 id="t274.1.3 ç¼ºç‚¹">4.1.3 ç¼ºç‚¹ <a href="#t274.1.3 ç¼ºç‚¹"> # </a></h3>
<ul>
<li>å¦‚æœäº§å“çš„ç§ç±»éå¸¸å¤š<code>switch case</code>çš„åˆ¤æ–­ä¼šå˜å¾—éå¸¸å¤š</li>
<li>ä¸ç¬¦åˆå¼€æ”¾â€”å°é—­åŸåˆ™,å¦‚æœè¦å¢åŠ æˆ–åˆ é™¤ä¸€ä¸ªäº§å“ç§ç±»ï¼Œå°±è¦ä¿®æ”¹<code>switch case</code>çš„åˆ¤æ–­ä»£ç </li>
</ul>
<h4 id="t284.1.3 å‰ç«¯åº”ç”¨åœºæ™¯">4.1.3 å‰ç«¯åº”ç”¨åœºæ™¯ <a href="#t284.1.3 å‰ç«¯åº”ç”¨åœºæ™¯"> # </a></h4>
<h5 id="t294.1.3.1 jQuery">4.1.3.1 jQuery <a href="#t294.1.3.1 jQuery"> # </a></h5>
<ul>
<li><a href="https://github.com/jquery/jquery/blob/c1ee33aded44051b8f1288b59d2efdc68d0413cc/src/core.js#L24-L29">jQuery</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">jQuery</span></span>{
    <span class="hljs-keyword">constructor</span>(selector){
        <span class="hljs-keyword">let</span> elements = <span class="hljs-built_in">Array</span>.from(<span class="hljs-built_in">document</span>.querySelectorAll(selector));
        <span class="hljs-keyword">let</span> length = elements?elements.length:<span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>;i&lt;length;i++){
            <span class="hljs-keyword">this</span>[i]=elements[i];
        }
        <span class="hljs-keyword">this</span>.length = length;
    }
    html(html){
        <span class="hljs-keyword">if</span>(html){
           <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>].innerHTML=html;
        }<span class="hljs-keyword">else</span>{
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>].innerHTML;
        }
    }
}
<span class="hljs-built_in">window</span>.$ = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">selector</span>)</span>{
   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> jQuery(selector);
}
</code></pre>
<h5 id="t304.1.3.2 React">4.1.3.2 React <a href="#t304.1.3.2 React"> # </a></h5>
<ul>
<li><a href="https://github.com/facebook/react/blob/master/packages/react/src/ReactElement.js#L313-L395">createElement</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createElement</span>(<span class="hljs-params">type, config, children</span>) </span>{
    <span class="hljs-keyword">return</span> ReactElement(
        type,
        key,
        ref,
        self,
        source,
        ReactCurrentOwner.current,
        props,
    );
}
</code></pre>
<h3 id="t314.2 å·¥å‚æ–¹æ³•æ¨¡å¼">4.2 å·¥å‚æ–¹æ³•æ¨¡å¼ <a href="#t314.2 å·¥å‚æ–¹æ³•æ¨¡å¼"> # </a></h3>
<ul>
<li>å·¥å‚æ–¹æ³•æ¨¡å¼<code>Factory Method</code>,åˆç§°å¤šæ€æ€§å·¥å‚æ¨¡å¼ã€‚</li>
<li>åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­,æ ¸å¿ƒçš„å·¥å‚ç±»ä¸å†è´Ÿè´£æ‰€æœ‰çš„äº§å“çš„åˆ›å»ºï¼Œè€Œæ˜¯å°†å…·ä½“åˆ›å»ºçš„å·¥ä½œäº¤ç»™å·¥å‚å­ç±»å»åšã€‚</li>
</ul>
<h4 id="t324.2.1 ç±»å›¾">4.2.1 ç±»å›¾ <a href="#t324.2.1 ç±»å›¾"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/factorymethod.png" alt="factorymethod"></p>
<h4 id="t334.2.2 ä»£ç ">4.2.2 ä»£ç  <a href="#t334.2.2 ä»£ç "> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> { }
abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Coffee</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string) {

    }
}
abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Factory</span> </span>{
    abstract createCoffee(): Coffee;
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AmericanoCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coffee</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string) {
        <span class="hljs-keyword">super</span>(name);
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AmericanoCoffeeFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Factory</span> </span>{
    createCoffee() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AmericanoCoffee(<span class="hljs-string">'ç¾å¼å’–å•¡'</span>)
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LatteCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coffee</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string) {
        <span class="hljs-keyword">super</span>(name);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LatteCoffeeFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Factory</span> </span>{
    createCoffee() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> LatteCoffee(<span class="hljs-string">'æ‹¿é“å’–å•¡'</span>)
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CappuccinoCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Coffee</span> </span>{
    <span class="hljs-keyword">constructor</span>(public name: string) {
        <span class="hljs-keyword">super</span>(name);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CappuccinoFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Factory</span> </span>{
    createCoffee() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CappuccinoCoffee(<span class="hljs-string">'å¡å¸ƒå¥‡è¯º'</span>)
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Caf</span>Ã© </span>{
    <span class="hljs-keyword">static</span> order(name: string) {
        <span class="hljs-keyword">switch</span> (name) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'Americano'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AmericanoCoffeeFactory().createCoffee();
            <span class="hljs-keyword">case</span> <span class="hljs-string">'Latte'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> LatteCoffeeFactory().createCoffee();
            <span class="hljs-keyword">case</span> <span class="hljs-string">'Cappuccino'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CappuccinoFactory().createCoffee();
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }
}
<span class="hljs-built_in">console</span>.log(CafÃ©.order(<span class="hljs-string">'Americano'</span>));
<span class="hljs-built_in">console</span>.log(CafÃ©.order(<span class="hljs-string">'Latte'</span>));
<span class="hljs-built_in">console</span>.log(CafÃ©.order(<span class="hljs-string">'Cappuccino'</span>));
</code></pre>
<h4 id="t344.2.3 åº”ç”¨åœºæ™¯">4.2.3 åº”ç”¨åœºæ™¯ <a href="#t344.2.3 åº”ç”¨åœºæ™¯"> # </a></h4>
<h5 id="t354.2.3.1 React">4.2.3.1 React <a href="#t354.2.3.1 React"> # </a></h5>
<ul>
<li><a href="https://github.com/facebook/react/blob/master/packages/react/src/ReactElement.js#L401-L409">createFactory</a></li>
</ul>
<h3 id="t364.3 æŠ½è±¡å·¥å‚æ¨¡å¼">4.3 æŠ½è±¡å·¥å‚æ¨¡å¼ <a href="#t364.3 æŠ½è±¡å·¥å‚æ¨¡å¼"> # </a></h3>
<ul>
<li>æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥å‘å®¢æˆ·ç«¯æä¾›ä¸€ä¸ªæ¥å£ï¼Œä½¿å®¢æˆ·ç«¯åœ¨ä¸å¿…æŒ‡å®šäº§å“çš„å…·ä½“çš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºå¤šä¸ªäº§å“æ—ä¸­çš„äº§å“å¯¹è±¡</li>
<li>å·¥å‚æ–¹æ³•æ¨¡å¼é’ˆå¯¹çš„æ˜¯åŒä¸€ç±»æˆ–åŒç­‰çº§äº§å“,è€ŒæŠ½è±¡å·¥å‚æ¨¡å¼é’ˆå¯¹çš„æ˜¯å¤šç§ç±»çš„äº§å“è®¾è®¡</li>
<li>ç³»ç»Ÿä¸­æœ‰å¤šä¸ªäº§å“æ—ï¼Œæ¯ä¸ªå…·ä½“å·¥å‚è´Ÿè´£åˆ›å»ºåŒä¸€æ—ä½†å±äºä¸åŒäº§å“ç­‰çº§(äº§å“ç§ç±»)çš„äº§å“</li>
<li>äº§å“æ—æ˜¯ä¸€ç»„ç›¸å…³æˆ–ç›¸äº’ä¾èµ–çš„å¯¹è±¡</li>
<li>ç³»ç»Ÿä¸€æ¬¡åªèƒ½æ¶ˆè´¹æŸä¸€æ—äº§å“ï¼Œå³ç›¸åŒäº§å“æ—çš„äº§å“æ˜¯ä¸€èµ·è¢«ä½¿ç”¨çš„</li>
<li>å½“ç³»ç»Ÿéœ€è¦æ–°å¢ä¸€ä¸ªäº§å“æ—æ—¶ï¼Œåªéœ€è¦å¢åŠ æ–°çš„å·¥å‚ç±»å³å¯ï¼Œæ— éœ€ä¿®æ”¹æºä»£ç ï¼›ä½†æ˜¯å¦‚æœéœ€è¦äº§å“æ—ä¸­å¢åŠ ä¸€ä¸ªæ–°ç§ç±»çš„äº§å“æ—¶ï¼Œåˆ™æ‰€æœ‰çš„å·¥å‚ç±»éƒ½éœ€è¦ä¿®æ”¹</li>
</ul>
<h4 id="t374.3.1  ç»„æˆè§’è‰²">4.3.1  ç»„æˆè§’è‰² <a href="#t374.3.1  ç»„æˆè§’è‰²"> # </a></h4>
<ul>
<li>æŠ½è±¡å·¥å‚: æä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£,åŒ…å«å¤šä¸ªåˆ›å»ºäº§å“çš„æ–¹æ³•,å³åŒ…å«å¤šä¸ªç±»ä¼¼åˆ›å»ºäº§å“çš„æ–¹æ³•</li>
<li>å…·ä½“å·¥å‚: å®ç°æŠ½è±¡å·¥å‚å®šä¹‰çš„æ¥å£,å®ŒæˆæŸä¸ªå…·ä½“äº§å“çš„åˆ›å»º</li>
<li>æŠ½è±¡äº§å“: æŠ½è±¡äº§å“å®šä¹‰,ä¸€èˆ¬æœ‰å¤šå°‘æŠ½è±¡äº§å“,æŠ½è±¡å·¥å‚ä¸­å°±åŒ…å«å¤šå°‘ä¸ªåˆ›å»ºäº§å“çš„æ–¹æ³•</li>
<li>å…·ä½“äº§å“: æŠ½è±¡äº§å“çš„å®ç°ç±»</li>
</ul>
<h4 id="t384.3.1 ç±»å›¾">4.3.1 ç±»å›¾ <a href="#t384.3.1 ç±»å›¾"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/abstractfactory3.png" alt="abstractfactory3"></p>
<p><img src="http://img.zhufengpeixun.cn/abstractfactory2.png" alt="abstractfactory2"></p>
<h4 id="t394.3.2 ä»£ç ">4.3.2 ä»£ç  <a href="#t394.3.2 ä»£ç "> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> { };
abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AmericanoCoffee</span> </span>{ }
abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LatteCoffee</span> </span>{ }
abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CappuccinoCoffee</span> </span>{ }

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StarbucksAmericanoCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AmericanoCoffee</span> </span>{ }
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StarbucksLatteCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">LatteCoffee</span> </span>{ }
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StarbucksCappuccinoCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CappuccinoCoffee</span> </span>{ }

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LuckinAmericanoCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AmericanoCoffee</span> </span>{ }
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LuckinLatteCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">LatteCoffee</span> </span>{ }
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LuckinCappuccinoCoffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CappuccinoCoffee</span> </span>{ }

abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CafeFactory</span> </span>{
    abstract createAmericanoCoffee(): AmericanoCoffee;
    abstract createLatteCoffee(): LatteCoffee;
    abstract createCappuccinoCoffee(): CappuccinoCoffee;
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StarbucksCafeFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CafeFactory</span> </span>{
    createAmericanoCoffee() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> StarbucksAmericanoCoffee();
    }
    createLatteCoffee() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> StarbucksLatteCoffee();
    }
    createCappuccinoCoffee() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> StarbucksCappuccinoCoffee();
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LuckinCafeFactory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CafeFactory</span> </span>{
    createAmericanoCoffee() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> LuckinAmericanoCoffee();
    }
    createLatteCoffee() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> LuckinLatteCoffee();
    }
    createCappuccinoCoffee() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> LuckinCappuccinoCoffee();
    }
}

<span class="hljs-keyword">let</span> starbucksCafeFactory = <span class="hljs-keyword">new</span> StarbucksCafeFactory();
<span class="hljs-built_in">console</span>.log(starbucksCafeFactory.createAmericanoCoffee());
<span class="hljs-built_in">console</span>.log(starbucksCafeFactory.createCappuccinoCoffee());
<span class="hljs-built_in">console</span>.log(starbucksCafeFactory.createLatteCoffee());

<span class="hljs-keyword">let</span> luckinCafeFactory = <span class="hljs-keyword">new</span> LuckinCafeFactory();
<span class="hljs-built_in">console</span>.log(luckinCafeFactory.createAmericanoCoffee());
<span class="hljs-built_in">console</span>.log(luckinCafeFactory.createCappuccinoCoffee());
<span class="hljs-built_in">console</span>.log(luckinCafeFactory.createLatteCoffee());
</code></pre>
<h2 id="t405.å•ä¾‹æ¨¡å¼">5.å•ä¾‹æ¨¡å¼ <a href="#t405.å•ä¾‹æ¨¡å¼"> # </a></h2>
<h4 id="t415.1 ç±»å›¾">5.1 ç±»å›¾ <a href="#t415.1 ç±»å›¾"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/singleobject.jpg" alt="singleobject"></p>
<h4 id="t425.2 ä»£ç ">5.2 ä»£ç  <a href="#t425.2 ä»£ç "> # </a></h4>
<h5 id="t435.2.1 å•ä¾‹æ¨¡å¼">5.2.1 å•ä¾‹æ¨¡å¼ <a href="#t435.2.1 å•ä¾‹æ¨¡å¼"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> { };
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Window</span> </span>{
    private <span class="hljs-keyword">static</span> instance: Window;
    private <span class="hljs-keyword">constructor</span>() { }
    <span class="hljs-keyword">static</span> getInstance() {
        <span class="hljs-keyword">if</span> (!Window.instance) {
            Window.instance = <span class="hljs-keyword">new</span> Window();
        }
        <span class="hljs-keyword">return</span> Window.instance;
    }
}
<span class="hljs-comment">//new Window();</span>
<span class="hljs-keyword">var</span> w1 = Window.getInstance();
<span class="hljs-keyword">var</span> w2 = Window.getInstance();
<span class="hljs-built_in">console</span>.log(w1 === w2);
</code></pre>
<h5 id="t445.2.2 ES5å•ä¾‹æ¨¡å¼">5.2.2 ES5å•ä¾‹æ¨¡å¼ <a href="#t445.2.2 ES5å•ä¾‹æ¨¡å¼"> # </a></h5>
<pre><code class="lang-js">interface Window {
    <span class="hljs-attr">hello</span>: any
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Window</span>(<span class="hljs-params"></span>) </span>{ }
Window.prototype.hello = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'hello'</span>);
}
Window.getInstance = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> <span class="hljs-built_in">window</span>: Window;
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>)
            <span class="hljs-built_in">window</span> = <span class="hljs-keyword">new</span> (Window <span class="hljs-keyword">as</span> any)();
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>;
    }
})();
<span class="hljs-keyword">let</span> <span class="hljs-built_in">window</span> = Window.getInstance();
<span class="hljs-built_in">window</span>.hello();
</code></pre>
<h5 id="t455.2.3 é€æ˜å•ä¾‹">5.2.3 é€æ˜å•ä¾‹ <a href="#t455.2.3 é€æ˜å•ä¾‹"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> Window = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> <span class="hljs-built_in">window</span>: Window;
    <span class="hljs-keyword">let</span> Window = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">this: Window</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> (<span class="hljs-built_in">window</span> = <span class="hljs-keyword">this</span>);
        }
    }
    Window.prototype.hello = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'hello'</span>);
    }
    <span class="hljs-keyword">return</span> Window;
})();

<span class="hljs-keyword">let</span> window1 = <span class="hljs-keyword">new</span> (Window <span class="hljs-keyword">as</span> any)();
<span class="hljs-keyword">let</span> window2 = <span class="hljs-keyword">new</span> (Window <span class="hljs-keyword">as</span> any)();
window1.hello();
<span class="hljs-built_in">console</span>.log(window1 === window2)
</code></pre>
<h5 id="t465.2.4 å•ä¾‹ä¸æ„å»ºåˆ†ç¦»">5.2.4 å•ä¾‹ä¸æ„å»ºåˆ†ç¦» <a href="#t465.2.4 å•ä¾‹ä¸æ„å»ºåˆ†ç¦»"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> { }
interface Window {
    <span class="hljs-attr">hello</span>: any
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Window</span>(<span class="hljs-params"></span>) </span>{
}
Window.prototype.hello = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'hello'</span>);
}

<span class="hljs-keyword">let</span> createInstance = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> instance: Window;
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">if</span> (!instance) {
            instance = <span class="hljs-keyword">new</span> (Window <span class="hljs-keyword">as</span> any)();
        }
        <span class="hljs-keyword">return</span> instance;
    }
})();

<span class="hljs-keyword">let</span> window1 = createInstance();
<span class="hljs-keyword">let</span> window2 = createInstance();
window1.hello();
<span class="hljs-built_in">console</span>.log(window1 === window2)
</code></pre>
<h5 id="t475.2.5 å°è£…å˜åŒ–">5.2.5 å°è£…å˜åŒ– <a href="#t475.2.5 å°è£…å˜åŒ–"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> { }
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Window</span>(<span class="hljs-params"></span>) </span>{

}
Window.prototype.hello = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'hello'</span>);
}

<span class="hljs-keyword">let</span> createInstance = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">Constructor: any</span>) </span>{
    <span class="hljs-keyword">let</span> instance: any;
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">this: any</span>) </span>{
        <span class="hljs-keyword">if</span> (!instance) {
            Constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            <span class="hljs-built_in">Object</span>.setPrototypeOf(<span class="hljs-keyword">this</span>, Constructor.prototype)
            instance = <span class="hljs-keyword">this</span>;
        }
        <span class="hljs-keyword">return</span> instance;
    }
};
<span class="hljs-keyword">let</span> CreateWindow: any = createInstance(Window);
<span class="hljs-keyword">let</span> window1 = <span class="hljs-keyword">new</span> CreateWindow();
<span class="hljs-keyword">let</span> window2 = <span class="hljs-keyword">new</span> CreateWindow();
window1.hello();
<span class="hljs-built_in">console</span>.log(window1 === window2)
</code></pre>
<h4 id="t485.3 åœºæ™¯">5.3 åœºæ™¯ <a href="#t485.3 åœºæ™¯"> # </a></h4>
<h5 id="t495.3.2 commonjs">5.3.2 commonjs <a href="#t495.3.2 commonjs"> # </a></h5>
<ul>
<li><a href="https://github.com/webpack/webpack/blob/8070bcd333cd1d07ce13fe5e91530c80779d51c6/lib/hmr/HotModuleReplacement.runtime.js#L55">HotModuleReplacement</a></li>
</ul>
<pre><code class="lang-js">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">modules</span>) </span>{
  <span class="hljs-comment">// webpackçš„å¯åŠ¨å‡½æ•°</span>
  <span class="hljs-comment">//æ¨¡å—çš„ç¼“å­˜</span>
  <span class="hljs-keyword">var</span> installedModules = {};
  <span class="hljs-comment">//å®šä¹‰åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨çš„requireæ–¹æ³•</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__webpack_require__</span>(<span class="hljs-params">moduleId</span>) </span>{
    <span class="hljs-comment">//æ£€æŸ¥æ¨¡å—æ˜¯å¦åœ¨ç¼“å­˜ä¸­</span>
    <span class="hljs-keyword">if</span> (installedModules[moduleId]) {
      <span class="hljs-keyword">return</span> installedModules[moduleId].exports;
    }
    <span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å—å¹¶ä¸”æ”¾åˆ°æ¨¡å—çš„ç¼“å­˜ä¸­</span>
    <span class="hljs-keyword">var</span> <span class="hljs-built_in">module</span> = (installedModules[moduleId] = {
      <span class="hljs-attr">i</span>: moduleId,
      <span class="hljs-attr">l</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">exports</span>: {}
    });

    <span class="hljs-comment">//æ‰§è¡Œæ¨¡å—å‡½æ•°</span>
    modules[moduleId].call(
      <span class="hljs-built_in">module</span>.exports,
      <span class="hljs-built_in">module</span>,
      <span class="hljs-built_in">module</span>.exports,
      __webpack_require__
    );

    <span class="hljs-comment">//æŠŠæ¨¡å—è®¾ç½®ä¸ºå·²ç»åŠ è½½</span>
    <span class="hljs-built_in">module</span>.l = <span class="hljs-literal">true</span>;

    <span class="hljs-comment">//è¿”å›æ¨¡å—çš„å¯¼å‡ºå¯¹è±¡</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">module</span>.exports;
  }
}
</code></pre>
<h5 id="t505.3.2 jQuery">5.3.2 jQuery <a href="#t505.3.2 jQuery"> # </a></h5>
<ul>
<li><a href="https://code.jquery.com/jquery-3.4.1.js">jquery</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">if</span>(<span class="hljs-built_in">window</span>.jQuery!=<span class="hljs-literal">null</span>){
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.jQuery;
}<span class="hljs-keyword">else</span>{
    <span class="hljs-comment">//init~~~~~~~</span>
}
</code></pre>
<h5 id="t515.3.3 æ¨¡æ€çª—å£">5.3.3 æ¨¡æ€çª—å£ <a href="#t515.3.3 æ¨¡æ€çª—å£"> # </a></h5>
<ul>
<li><a href="https://github.com/twbs/bootstrap/blob/master/js/src/modal.js">bootstrap modal.js</a></li>
</ul>
<pre><code class="lang-js">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;button id="show-button"&gt;æ˜¾ç¤ºæ¨¡æ€çª—å£&lt;/button&gt;
    &lt;button id="hide-button"&gt;éšè—æ¨¡æ€çª—å£&lt;/button&gt;
    &lt;script&gt;
        class Login {
            constructor() {
                this.element = document.createElement('div');
                this.element.innerHTML = (
                    `
            ç”¨æˆ·å &lt;input type="text"/&gt;
            &lt;button&gt;ç™»å½•&lt;/button&gt;
            `
                );
                this.element.style.cssText = 'width: 100px; height: 100px; position: absolute; left: 50%; top: 50%; display: block;';
                document.body.appendChild(this.element);
            }
            show() {
                this.element.style.display = 'block';
            }
            hide() {
                this.element.style.display = 'none';
            }
        }
        Login.getInstance = (function () {
            let instance;
            return function () {
                if (!instance) {
                    instance = new Login();
                }
                return instance;
            }
        })();

        document.getElementById('show-button').addEventListener('click', function (event) {
            Login.getInstance().show();
        });
        document.getElementById('hide-button').addEventListener('click', function (event) {
            Login.getInstance().hide();
        });
    &lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
<h5 id="t525.3.4 store">5.3.4 store <a href="#t525.3.4 store"> # </a></h5>
<ul>
<li><a href="https://github.com/reduxjs/redux/blob/master/src/createStore.ts">createStore.ts</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createStore</span>(<span class="hljs-params">reducer: any</span>) </span>{
    <span class="hljs-keyword">let</span> state: any;
    <span class="hljs-keyword">let</span> listeners: any[] = [];
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getState</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> state;
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dispatch</span>(<span class="hljs-params">action: any</span>) </span>{
        state = reducer(state, action);
        listeners.forEach(<span class="hljs-function"><span class="hljs-params">l</span> =&gt;</span> l());
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subscribe</span>(<span class="hljs-params">listener: any</span>) </span>{
        listeners.push(listener);
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            listeners = listeners.filter(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item != listener);
            <span class="hljs-built_in">console</span>.log(listeners);
        }
    }
    dispatch({});
    <span class="hljs-keyword">return</span> {
        getState,
        dispatch,
        subscribe
    }
}
<span class="hljs-keyword">let</span> store = createStore(<span class="hljs-function">(<span class="hljs-params">state: any, action: any</span>) =&gt;</span> state);
</code></pre>
<h5 id="t535.3.5 ç¼“å­˜">5.3.5 ç¼“å­˜ <a href="#t535.3.5 ç¼“å­˜"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">let</span> cache: Record&lt;any, any&gt; = {};
<span class="hljs-keyword">let</span> app = express();
app.get(<span class="hljs-string">'/user/:id'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req: any, res: any</span>) </span>{
    <span class="hljs-keyword">let</span> id = req.params.id;
    <span class="hljs-keyword">let</span> user = cache.get(id);
    <span class="hljs-keyword">if</span> (user) {
        res.json(user);
    } <span class="hljs-keyword">else</span> {
        fs.readFile(<span class="hljs-string">`./users/<span class="hljs-subst">${id}</span>.json`</span>, <span class="hljs-string">'utf8'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err: any, data: any</span>) </span>{
            <span class="hljs-keyword">let</span> user = <span class="hljs-built_in">JSON</span>.parse(data);
            cache.put(id, user);
            res.json(user);
        });
    }
});
app.listen(<span class="hljs-number">3000</span>);
</code></pre>
<h2 id="t546. é€‚é…å™¨æ¨¡å¼">6. é€‚é…å™¨æ¨¡å¼ <a href="#t546. é€‚é…å™¨æ¨¡å¼"> # </a></h2>
<ul>
<li>é€‚é…å™¨æ¨¡å¼åˆç§°åŒ…è£…å™¨æ¨¡å¼,å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬åŒ–ä¸ºç”¨æˆ·éœ€è¦çš„å¦ä¸€ä¸ªæ¥å£,è§£å†³ç±»(å¯¹è±¡)ä¹‹é—´æ¥å£ä¸å…¼å®¹çš„é—®é¢˜</li>
<li>æ—§çš„æ¥å£å’Œä½¿ç”¨è€…ä¸å…¼å®¹</li>
<li>ä¸­é—´åŠ ä¸€ä¸ªé€‚é…å™¨è½¬æ¢æ¥å£</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/myadapor.jpg" alt="myadapor"></p>
<h4 id="t556.1 ç±»å›¾">6.1 ç±»å›¾ <a href="#t556.1 ç±»å›¾"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/poweradaptor4.png" alt="poweradaptor4"></p>
<p><img src="http://img.zhufengpeixun.cn/myadapters.png" alt="myadapters"></p>
<h4 id="t566.2 ä»£ç ">6.2 ä»£ç  <a href="#t566.2 ä»£ç "> # </a></h4>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Socket</span> </span>{
    output() {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'è¾“å‡º220V'</span>;
    }
}

abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Power</span> </span>{
    abstract charge(): string;
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PowerAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Power</span> </span>{
    <span class="hljs-keyword">constructor</span>(public socket: Socket) {
        <span class="hljs-keyword">super</span>();
    }
    <span class="hljs-comment">//è½¬æ¢åçš„æ¥å£å’Œè½¬æ¢å‰ä¸ä¸€æ ·</span>
    charge() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.socket.output() + <span class="hljs-string">' ç»è¿‡è½¬æ¢ è¾“å‡º24V'</span>;
    }
}
<span class="hljs-keyword">let</span> powerAdapter = <span class="hljs-keyword">new</span> PowerAdapter(<span class="hljs-keyword">new</span> Socket());
<span class="hljs-built_in">console</span>.log(powerAdapter.charge());
</code></pre>
<h4 id="t576.3 åœºæ™¯">6.3 åœºæ™¯ <a href="#t576.3 åœºæ™¯"> # </a></h4>
<h5 id="t586.2.1 axios">6.2.1 axios <a href="#t586.2.1 axios"> # </a></h5>
<ul>
<li><a href="https://github.com/axios/axios/blob/master/lib/core/Axios.js#L6">Axios</a></li>
<li><a href="https://github.com/axios/axios/blob/master/lib/core/dispatchRequest.js#L50-L79">dispatchRequest</a></li>
<li><a href="https://github.com/axios/axios/blob/master/lib/defaults.js#L16-L26">defaults</a></li>
<li><a href="https://github.com/axios/axios/blob/dc4bc49673943e35280e5df831f5c3d0347a9393/lib/adapters/xhr.js">xhr</a></li>
<li><a href="https://github.com/axios/axios/blob/dc4bc49673943e35280e5df831f5c3d0347a9393/lib/adapters/http.js">http</a></li>
<li>é€‚é…å™¨çš„å…¥å‚éƒ½æ˜¯<code>config</code>,è¿”å›çš„éƒ½æ˜¯<code>promise</code></li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">//let axios = require('axios');</span>
<span class="hljs-keyword">let</span> url = <span class="hljs-built_in">require</span>(<span class="hljs-string">'url'</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">axios</span>(<span class="hljs-params">config: any</span>): <span class="hljs-title">any</span> </span>{
    <span class="hljs-keyword">let</span> adaptor = getDefaultAdapter();
    <span class="hljs-keyword">return</span> adaptor(config);
}
axios({
    <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
    <span class="hljs-attr">url</span>: <span class="hljs-string">'http://localhost:8080/api/user?id=1'</span>
}).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response: any</span>) </span>{
    <span class="hljs-built_in">console</span>.log(response);
}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error: any</span>) </span>{
    <span class="hljs-built_in">console</span>.log(error);
})

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">xhr</span>(<span class="hljs-params">config: any</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>{
        <span class="hljs-keyword">var</span> request = <span class="hljs-keyword">new</span> XMLHttpRequest();
        request.open(config.method, config.url, <span class="hljs-literal">true</span>);
        request.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (request.readyState == <span class="hljs-number">4</span>) {
                <span class="hljs-keyword">if</span> (request.status == <span class="hljs-number">200</span>) {
                    resolve(request.response);
                } <span class="hljs-keyword">else</span> {
                    reject(<span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>);
                }
            }
        }
    })
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">http</span>(<span class="hljs-params">config: any</span>) </span>{
    <span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);
    <span class="hljs-keyword">let</span> urlObject = url.parse(config.url);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>{
        <span class="hljs-keyword">const</span> options = {
            <span class="hljs-attr">hostname</span>: urlObject.hostname,
            <span class="hljs-attr">port</span>: urlObject.port,
            <span class="hljs-attr">path</span>: urlObject.pathname,
            <span class="hljs-attr">method</span>: config.method
        };
        <span class="hljs-keyword">var</span> req = http.request(options, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res: any</span>) </span>{
            <span class="hljs-keyword">let</span> chunks: any[] = [];
            res.on(<span class="hljs-string">'data'</span>, (chunk: any) =&gt; {
                chunks.push(chunk);
            });
            res.on(<span class="hljs-string">'end'</span>, () =&gt; {
                resolve(Buffer.concat(chunks).toString());
            });
        });
        req.on(<span class="hljs-string">'error'</span>, (err: any) =&gt; {
            reject(err);
        });
        req.end();
    })
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDefaultAdapter</span>(<span class="hljs-params"></span>): <span class="hljs-title">any</span> </span>{
    <span class="hljs-keyword">var</span> adapter;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> XMLHttpRequest !== <span class="hljs-string">'undefined'</span>) {
        adapter = xhr;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> process !== <span class="hljs-string">'undefined'</span>) {
        adapter = http;
    }
    <span class="hljs-keyword">return</span> adapter;
}
</code></pre>
<p>server.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">let</span> app = express();
app.get(<span class="hljs-string">'/api/user'</span>, (req, res) =&gt; {
    res.json({ <span class="hljs-attr">id</span>: req.query.id, <span class="hljs-attr">name</span>: <span class="hljs-string">'zhufeng'</span> });
});
app.listen(<span class="hljs-number">8080</span>);
</code></pre>
<h5 id="t596.2.2 toAxiosAdapter">6.2.2 toAxiosAdapter <a href="#t596.2.2 toAxiosAdapter"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toAxiosAdapter</span>(<span class="hljs-params">options: any</span>) </span>{
    <span class="hljs-keyword">return</span> axios({
        <span class="hljs-attr">url</span>: options.url,
        <span class="hljs-attr">method</span>: options.type
    }).then(options.success)
        .catch(options.error)
}


$.ajax = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options: any</span>) </span>{
    <span class="hljs-keyword">return</span> toAxiosAdapter(options)
}

$.ajax({
    <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/user'</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'GET'</span>,
    <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data: any</span>) </span>{
        <span class="hljs-built_in">console</span>.log(data)
    },
    <span class="hljs-attr">error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err: any</span>) </span>{
        <span class="hljs-built_in">console</span>.error(err);
    }
})
</code></pre>
<h5 id="t606.2.3 promisify">6.2.3 promisify <a href="#t606.2.3 promisify"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">var</span> Bluebird = <span class="hljs-built_in">require</span>(<span class="hljs-string">"bluebird"</span>);
<span class="hljs-keyword">let</span> readFile = Bluebird.promisify(fs.readFile);

(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> content = <span class="hljs-keyword">await</span> readFile(<span class="hljs-string">'./1.txt'</span>, <span class="hljs-string">'utf8'</span>);
    <span class="hljs-built_in">console</span>.log(content);
})()
</code></pre>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">promisify</span>(<span class="hljs-params">readFile: any</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">filename: any, encoding: any</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve, reject</span>) </span>{
            readFile(filename, encoding, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err: any, data: any</span>) </span>{
                <span class="hljs-keyword">if</span> (err)
                    reject(err);
                <span class="hljs-keyword">else</span>
                    resolve(data);
            })
        });
    }
}
</code></pre>
<h5 id="t616.2.4 computed">6.2.4 computed <a href="#t616.2.4 computed"> # </a></h5>
<pre><code class="lang-js">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
    &lt;script src="https://cdn.bootcss.com/vue/2.5.17/vue.js"&gt;&lt;/script&gt;
    &lt;title&gt;vue&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="root"&gt;
&lt;p&gt;{{name}}&lt;/p&gt;
&lt;p&gt;{{upperName}}&lt;/p&gt;
&lt;/div&gt;    
&lt;script&gt;
let vm=new Vue({
    el: '#root',
    data: {
        name:'zfpx'
    },
    computed: {
        upperName() {
            return this.name.toUpperCase();
        }
    }
});
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h5 id="t626.2.5 tree">6.2.5 tree <a href="#t626.2.5 tree"> # </a></h5>
<ul>
<li>æ ‘å‹ç»“æ„æ•°æ®åœ¨ä¸‹æ‹‰æ¡†ä¸­æ˜¾ç¤º</li>
</ul>
<pre><code class="lang-js">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;select id="users"&gt;&lt;/select&gt;
    &lt;script&gt;
        let tree = [{
            name: 'çˆ¶äº²',
            key: '1',
            children: [
                {
                    name: 'å„¿å­',
                    key: '1-1',
                    children: [
                        {
                            name: 'å­™å­',
                            key: '1-1-1'
                        }
                    ]
                }
            ]
        }]
        function flattenAdapter(tree, flattenArray) {
            tree.forEach((item) =&gt; {
                if (item.children) {
                    flattenAdapter(item.children, flattenArray)
                }
                flattenArray.push({ name: item.name, key: item.key })
            })
            return flattenArray
        }
        let array = [];
        flattenAdapter(tree, array);
        array.reverse();
        let users = document.getElementById('users');
        let options = array.map(item =&gt; `&lt;option value="${item.key}"&gt;${item.name}&lt;/option&gt;`).join('');
        users.innerHTML = options;
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h5 id="t636.2.6 Sequelize">6.2.6 Sequelize <a href="#t636.2.6 Sequelize"> # </a></h5>
<ul>
<li><a href="https://github.com/demopark/sequelize-docs-Zh-CN/tree/master">sequelize</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-comment">//cnpm i sequelize sqlite3 -S</span>
<span class="hljs-keyword">const</span> { Sequelize, Model, DataTypes } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'sequelize'</span>);
<span class="hljs-keyword">const</span> sequelize = <span class="hljs-keyword">new</span> Sequelize(<span class="hljs-string">'sqlite::memory:'</span>);

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span> </span>{ }
User.init({
    <span class="hljs-attr">username</span>: DataTypes.STRING
}, { sequelize, <span class="hljs-attr">modelName</span>: <span class="hljs-string">'user'</span> });

sequelize.sync()
    .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> User.create({
        <span class="hljs-attr">username</span>: <span class="hljs-string">'zhufeng'</span>
    }))
    .then(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(result.toJSON());
    });
</code></pre>
<h2 id="t647.è£…é¥°å™¨æ¨¡å¼">7.è£…é¥°å™¨æ¨¡å¼ <a href="#t647.è£…é¥°å™¨æ¨¡å¼"> # </a></h2>
<ul>
<li>åœ¨ä¸æ”¹å˜å…¶åŸæœ‰çš„ç»“æ„å’ŒåŠŸèƒ½ä¸ºå¯¹è±¡æ·»åŠ æ–°åŠŸèƒ½çš„æ¨¡å¼å…¶å®å°±å«åšè£…é¥°å™¨æ¨¡å¼</li>
<li>æœ€ç›´è§‚åœ°å°±æ˜¯æˆ‘ä»¬ä¹°æˆ¿åçš„è£…ä¿®</li>
<li>è£…é¥°æ¯”ç»§æ‰¿æ›´åŠ çµæ´»,å¯ä»¥å®ç°è£…é¥°è€…å’Œè¢«è£…é¥°è€…ä¹‹é—´æ¾è€¦åˆ</li>
<li>è¢«è£…é¥°è€…å¯ä»¥ä½¿ç”¨è£…é¥°è€…åŠ¨æ€åœ°å¢åŠ å’Œæ’¤é”€åŠŸèƒ½</li>
</ul>
<h4 id="t657.1 ç±»å›¾">7.1 ç±»å›¾ <a href="#t657.1 ç±»å›¾"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/shapedecorator.png" alt="shapedecorator"></p>
<h4 id="t667.2 ä»£ç ">7.2 ä»£ç  <a href="#t667.2 ä»£ç "> # </a></h4>
<pre><code class="lang-js">
abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Shape</span> </span>{
    abstract draw(): <span class="hljs-keyword">void</span>;
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Shape</span> </span>{
    draw() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ç»˜åˆ¶åœ†å½¢'</span>);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Shape</span> </span>{
    draw() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ç»˜åˆ¶çŸ©å½¢'</span>);
    }
}

abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ColorfulShape</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Shape</span> </span>{
    public <span class="hljs-keyword">constructor</span>(public shape: Shape) {
        <span class="hljs-keyword">super</span>();
    }
    abstract draw(): <span class="hljs-keyword">void</span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedColorfulShape</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ColorfulShape</span> </span>{
    draw() {
        <span class="hljs-keyword">this</span>.shape.draw();
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æŠŠè¾¹æ¡†æ¶‚æˆçº¢è‰²'</span>);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GreenColorfulShape</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ColorfulShape</span> </span>{
    draw() {
        <span class="hljs-keyword">this</span>.shape.draw();
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æŠŠè¾¹æ¡†æ¶‚æˆç»¿è‰²'</span>);
    }
}

<span class="hljs-keyword">let</span> circle = <span class="hljs-keyword">new</span> Circle();
<span class="hljs-keyword">let</span> redColorfulShape = <span class="hljs-keyword">new</span> RedColorfulShape(circle);
redColorfulShape.draw();

<span class="hljs-keyword">let</span> rectangle = <span class="hljs-keyword">new</span> Rectangle();
<span class="hljs-keyword">let</span> greenColorfulShape = <span class="hljs-keyword">new</span> GreenColorfulShape(rectangle);
greenColorfulShape.draw();
</code></pre>
<h4 id="t677.3 åº”ç”¨åœºæ™¯">7.3 åº”ç”¨åœºæ™¯ <a href="#t677.3 åº”ç”¨åœºæ™¯"> # </a></h4>
<h5 id="t687.3.1  è£…é¥°å™¨">7.3.1  è£…é¥°å™¨ <a href="#t687.3.1  è£…é¥°å™¨"> # </a></h5>
<ul>
<li>è£…é¥°å™¨æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å£°æ˜ï¼Œå®ƒèƒ½å¤Ÿè¢«é™„åŠ åˆ°ç±»å£°æ˜ã€æ–¹æ³•ã€å±æ€§æˆ–å‚æ•°ä¸Šï¼Œå¯ä»¥ä¿®æ”¹ç±»çš„è¡Œä¸º</li>
<li>å¸¸è§çš„è£…é¥°å™¨æœ‰ç±»è£…é¥°å™¨ã€å±æ€§è£…é¥°å™¨ã€æ–¹æ³•è£…é¥°å™¨å’Œå‚æ•°è£…é¥°å™¨</li>
<li>è£…é¥°å™¨çš„å†™æ³•åˆ†ä¸ºæ™®é€šè£…é¥°å™¨å’Œè£…é¥°å™¨å·¥å‚</li>
</ul>
<h6 id="t697.3.1.1 ç±»è£…é¥°å™¨">7.3.1.1 ç±»è£…é¥°å™¨ <a href="#t697.3.1.1 ç±»è£…é¥°å™¨"> # </a></h6>
<ul>
<li>ç±»è£…é¥°å™¨åœ¨ç±»å£°æ˜ä¹‹å‰å£°æ˜ï¼Œç”¨æ¥ç›‘æ§ã€ä¿®æ”¹æˆ–æ›¿æ¢ç±»å®šä¹‰</li>
<li>å‚æ•°æ˜¯ç±»çš„å®šä¹‰æˆ–è€…è¯´æ„é€ å‡½æ•°</li>
<li><a href="https://babeljs.io/docs/en/babel-plugin-proposal-decorators">babel-plugin-proposal-decorators</a></li>
</ul>
<p>decorator</p>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> { }
namespace decorator {
    interface Animal {
        <span class="hljs-attr">swings</span>: string;
        fly: any
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flyable</span>(<span class="hljs-params">target: any</span>) </span>{
        <span class="hljs-built_in">console</span>.log(target);

        target.prototype.swings = <span class="hljs-number">2</span>;
        target.prototype.fly = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'I can fly'</span>);
        }
    }
    @flyable
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
        <span class="hljs-keyword">constructor</span>() { }
    }
    <span class="hljs-keyword">let</span> animal: Animal = <span class="hljs-keyword">new</span> Animal();
    <span class="hljs-built_in">console</span>.log(animal.swings);
    animal.fly();
}
</code></pre>
<p>decorator_factory</p>
<pre><code class="lang-js">namespace decorator_factory {
    interface Animal {
        <span class="hljs-attr">swings</span>: string;
        fly: any
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flyable</span>(<span class="hljs-params">swings: number</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flyable</span>(<span class="hljs-params">target: any</span>) </span>{
            <span class="hljs-built_in">console</span>.log(target);

            target.prototype.swings = swings;
            target.prototype.fly = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'I can fly'</span>);
            }
        }
    }

    @flyable(<span class="hljs-number">2</span>)
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
        <span class="hljs-keyword">constructor</span>() { }
    }
    <span class="hljs-keyword">let</span> animal: Animal = <span class="hljs-keyword">new</span> Animal();
    <span class="hljs-built_in">console</span>.log(animal.swings);
    animal.fly();
}
</code></pre>
<h6 id="t707.3.1.2  å±æ€§è£…é¥°å™¨">7.3.1.2  å±æ€§è£…é¥°å™¨ <a href="#t707.3.1.2  å±æ€§è£…é¥°å™¨"> # </a></h6>
<ul>
<li>å±æ€§è£…é¥°å™¨è¡¨è¾¾å¼ä¼šåœ¨è¿è¡Œæ—¶å½“ä½œå‡½æ•°è¢«è°ƒç”¨</li>
<li>å±æ€§åˆ†ä¸ºå®ä¾‹å±æ€§å’Œç±»å±æ€§</li>
<li>æ–¹æ³•åˆ†ä¸ºå®ä¾‹æ–¹æ³•å’Œç±»æ–¹æ³•</li>
</ul>
<pre><code class="lang-js">namespace property_namespace {
    <span class="hljs-comment">//å®ä¾‹å±æ€§targetæ˜¯ç±»çš„åŸå‹å¯¹è±¡,keyæ˜¯å±æ€§åç§°</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">instancePropertyDecorator</span>(<span class="hljs-params">target: any, key: string</span>) </span>{
    }
    <span class="hljs-comment">//ç±»å±æ€§targetæ˜¯çš„æ„é€ å‡½æ•°</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">classPropertyDecorator</span>(<span class="hljs-params">target: any, key: string</span>) </span>{
    }
    <span class="hljs-comment">//å®ä¾‹æ–¹æ³•è£…é¥°å™¨targetæ˜¯åŸå‹å¯¹è±¡,keyæ–¹æ³•å,descriptoræ˜¯æ–¹æ³•æè¿°ç¬¦</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">instanceMethodDecorator</span>(<span class="hljs-params">target: any, key: string, descriptor: PropertyDescriptor</span>) </span>{
    }
    <span class="hljs-comment">//ç±»æ–¹æ³•è£…é¥°å™¨targetæ˜¯ç±»çš„æ„é€ å‡½æ•°</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">classMethodDecorator</span>(<span class="hljs-params">target: any, key: string, descriptor: PropertyDescriptor</span>) </span>{
    }
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{
        @instancePropertyDecorator
        <span class="hljs-attr">instanceProperty</span>: string;
        @classPropertyDecorator
        public <span class="hljs-keyword">static</span> classProperty: string;
        @instanceMethodDecorator
        instanceMethod() {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'instanceMethod'</span>);
        }
        @classMethodDecorator
        classMethod() {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'classMethod'</span>);
        }
    }
}
</code></pre>
<h6 id="t717.3.1.3 core-decorator">7.3.1.3 core-decorator <a href="#t717.3.1.3 core-decorator"> # </a></h6>
<ul>
<li><a href="https://github.com/jayphelps/core-decorators">core-decorator</a></li>
<li><a href="https://github.com/jayphelps/core-decorators#deprecate-alias-deprecated">deprecate-alias-deprecated</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> { readonly } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'core-decorators'</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deprecate</span>(<span class="hljs-params">msg: string, options: any</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target: any, attr: any, descriptor: any</span>) </span>{
        <span class="hljs-comment">//DEPRECATION Calculator#add: This function will be removed in future versions.</span>
        <span class="hljs-keyword">let</span> oldVal = descriptor.value;
        descriptor.value = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args: any[]</span>) </span>{
            <span class="hljs-keyword">let</span> message = msg ? msg : <span class="hljs-string">`DEPRECATION <span class="hljs-subst">${target.constructor.name}</span>#<span class="hljs-subst">${attr}</span>: This function will be removed in future versions.`</span>;
            <span class="hljs-keyword">let</span> see = options &amp;&amp; options.url ? <span class="hljs-string">`see <span class="hljs-subst">${options.url}</span>`</span> : <span class="hljs-string">``</span>;
            <span class="hljs-built_in">console</span>.warn(message + <span class="hljs-string">'\r\n'</span> + see);
            <span class="hljs-keyword">return</span> oldVal(...args);
        }
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Calculator</span> </span>{
    @deprecate(<span class="hljs-string">'stop using this'</span>, { <span class="hljs-attr">url</span>: <span class="hljs-string">'http://www.baidu.com'</span> })
    add(a: number, <span class="hljs-attr">b</span>: number) {
        <span class="hljs-keyword">return</span> a + b;
    }
}
<span class="hljs-keyword">let</span> calculator = <span class="hljs-keyword">new</span> Calculator();
calculator.add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
</code></pre>
<h5 id="t727.3.2  AOPæ¦‚å¿µ">7.3.2  AOPæ¦‚å¿µ <a href="#t727.3.2  AOPæ¦‚å¿µ"> # </a></h5>
<ul>
<li>åœ¨è½¯ä»¶ä¸šï¼ŒAOPä¸º<code>Aspect Oriented Programming</code>çš„ç¼©å†™,æ„ä¸ºé¢å‘åˆ‡é¢ç¼–ç¨‹</li>
<li>å¯ä»¥é€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°åœ¨ä¸ä¿®æ”¹æºä»£ç çš„æƒ…å†µä¸‹ç»™ç¨‹åºåŠ¨æ€ç»Ÿä¸€æ·»åŠ åŠŸèƒ½çš„ä¸€ç§æŠ€æœ¯</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/springaop2.jpeg" alt="springaop"></p>
<p><img src="http://img.zhufengpeixun.cn/apoprogram.jpg" alt="apoprogram"></p>
<h5 id="t737.3.3 åŸ‹ç‚¹">7.3.3 åŸ‹ç‚¹ <a href="#t737.3.3 åŸ‹ç‚¹"> # </a></h5>
<ul>
<li>åŸ‹ç‚¹åˆ†æ: æ˜¯ç½‘ç«™åˆ†æçš„ä¸€ç§å¸¸ç”¨çš„æ•°æ®é‡‡é›†æ–¹æ³•</li>
<li>æ— ç—•åŸ‹ç‚¹: é€šè¿‡æŠ€æœ¯æ‰‹æ®µï¼Œå®Œæˆå¯¹ç”¨æˆ·è¡Œä¸ºæ•°æ®æ— å·®åˆ«çš„ç»Ÿè®¡ä¸Šä¼ çš„å·¥ä½œ,åæœŸæ•°æ®åˆ†æå¤„ç†çš„æ—¶å€™é€šè¿‡æŠ€æœ¯æ‰‹æ®µç­›é€‰å‡ºåˆé€‚çš„æ•°æ®è¿›è¡Œç»Ÿè®¡åˆ†æ</li>
</ul>
<h6 id="t747.3.3.1 é¡¹ç›®é…ç½®">7.3.3.1 é¡¹ç›®é…ç½® <a href="#t747.3.3.1 é¡¹ç›®é…ç½®"> # </a></h6>
<ol>
<li>åˆ›å»ºé¡¹ç›®</li>
</ol>
<pre><code class="lang-js">create-react-app zhufeng_tract
yarn add customize-cra react-app-rewired --dev
</code></pre>
<ol start="2">
<li><p>config-overrides.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> {
 override,
 addDecoratorsLegacy,
} = <span class="hljs-built_in">require</span>(<span class="hljs-string">"customize-cra"</span>);
<span class="hljs-built_in">module</span>.exports = override(
 addDecoratorsLegacy(),
);
</code></pre>
</li>
<li><p>jsconfig.json</p>
<pre><code class="lang-js">{
 <span class="hljs-string">"compilerOptions"</span>: {
     <span class="hljs-string">"experimentalDecorators"</span>: <span class="hljs-literal">true</span>
 }
}
</code></pre>
</li>
</ol>
<h6 id="t757.3.3.2 index.js">7.3.3.2 index.js <a href="#t757.3.3.2 index.js"> # </a></h6>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;
<span class="hljs-keyword">import</span> { before, after } <span class="hljs-keyword">from</span> <span class="hljs-string">'./track'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
    @before(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ç‚¹å‡»æ–¹æ³•æ‰§è¡Œå‰'</span>))
    onClickBeforeButton() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'beforeClick'</span>);
    }

    @after(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ç‚¹å‡»æ–¹æ³•æ‰§è¡Œå'</span>))
    onClickAfterButton() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'afterClick'</span>);
    }

    @after(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> fetch(<span class="hljs-string">'/api/report'</span>))
    onClickAjaxButton() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ajaxClick'</span>);
    }

    render() {
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.onClickBeforeButton}</span>&gt;</span>beforeClick<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.onClickAfterButton}</span>&gt;</span>afterClick<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.onClickAjaxButton}</span>&gt;</span>ajaxClick<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        )
    }
}
render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>));
</code></pre>
<h6 id="t767.3.3.3 track.js">7.3.3.3 track.js <a href="#t767.3.3.3 track.js"> # </a></h6>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> before = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">beforeFn</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target, methodName, descriptor</span>) </span>{
        <span class="hljs-keyword">let</span> oldMethod = descriptor.value;
        descriptor.value = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            beforeFn.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            <span class="hljs-keyword">return</span> oldMethod.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
        }
    }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> after = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">afterFn</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target, methodName, descriptor</span>) </span>{
        <span class="hljs-keyword">let</span> oldMethod = descriptor.value;
        descriptor.value = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            oldMethod.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            afterFn.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
        }
    }
}
</code></pre>
<h5 id="t777.3.4 è¡¨å•æ ¡éªŒ">7.3.4 è¡¨å•æ ¡éªŒ <a href="#t777.3.4 è¡¨å•æ ¡éªŒ"> # </a></h5>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç”¨æˆ·æ³¨å†Œ<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">""</span>&gt;</span>
        ç”¨æˆ·å<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span>&gt;</span>
        å¯†ç <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"submit-btn"</span>&gt;</span>æ³¨å†Œ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-built_in">Function</span>.prototype.before = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">beforeFn</span>) </span>{
            <span class="hljs-keyword">let</span> _this = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">let</span> ret = beforeFn.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
                <span class="hljs-keyword">if</span> (ret)
                    _this.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            }
        }
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submit</span>(<span class="hljs-params"></span>) </span>{
            alert(<span class="hljs-string">'æäº¤è¡¨å•'</span>);
        }
        submit = submit.before(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">let</span> username = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'username'</span>).value;
            <span class="hljs-keyword">if</span> (username.length &lt; <span class="hljs-number">6</span>) {
                <span class="hljs-keyword">return</span> alert(<span class="hljs-string">'ç”¨æˆ·åä¸èƒ½å°‘äº6ä½'</span>);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        });
        submit = submit.before(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">let</span> username = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'username'</span>).value;
            <span class="hljs-keyword">if</span> (!username) {
                <span class="hljs-keyword">return</span> alert(<span class="hljs-string">'ç”¨æˆ·åä¸èƒ½ä¸ºç©º'</span>);
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        });
        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'submit-btn'</span>).addEventListener(<span class="hljs-string">'click'</span>, submit);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 id="t788.ä»£ç†æ¨¡å¼">8.ä»£ç†æ¨¡å¼ <a href="#t788.ä»£ç†æ¨¡å¼"> # </a></h2>
<ul>
<li>ç”±äºä¸€ä¸ªå¯¹è±¡ä¸èƒ½ç›´æ¥å¼•ç”¨å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡ä»£ç†å¯¹è±¡åœ¨è¿™ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹ä½œç”¨</li>
<li>ä»£ç†æ¨¡å¼å°±æ˜¯ä¸ºç›®æ ‡å¯¹è±¡åˆ›é€ ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä»¥å®ç°å¯¹ç›®æ ‡å¯¹è±¡çš„è®¿é—®</li>
<li>è¿™æ ·å°±å¯ä»¥åœ¨ä»£ç†å¯¹è±¡é‡Œå¢åŠ ä¸€äº›é€»è¾‘åˆ¤æ–­ã€è°ƒç”¨å‰æˆ–è°ƒç”¨åæ‰§è¡Œä¸€äº›æ“ä½œï¼Œä»è€Œå®ç°äº†æ‰©å±•ç›®æ ‡çš„åŠŸèƒ½</li>
<li>ç«è½¦ç¥¨ä»£è´­ã€æˆ¿äº§ä¸­ä»‹ã€å¾‹å¸ˆã€æµ·å¤–ä»£è´­ã€æ˜æ˜Ÿç»çºªäºº</li>
</ul>
<h4 id="t798.1 ç±»å›¾">8.1 ç±»å›¾ <a href="#t798.1 ç±»å›¾"> # </a></h4>
<ul>
<li>Target ç›®æ ‡å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¢«ä»£ç†çš„å¯¹è±¡ï¼Œæ˜¯å…·ä½“ä¸šåŠ¡çš„æ‰§è¡Œè€…</li>
<li>Proxy ä»£ç†å¯¹è±¡ï¼Œé‡Œé¢ä¼šåŒ…å«ä¸€ä¸ªç›®æ ‡å¯¹è±¡çš„å¼•ç”¨ï¼Œå¯ä»¥å®ç°å¯¹è®¿é—®çš„æ‰©å±•å’Œé¢å¤–å¤„ç†</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/proxystar.png" alt="proxystar"></p>
<h4 id="t808.2 ä»£ç ">8.2 ä»£ç  <a href="#t808.2 ä»£ç "> # </a></h4>
<pre><code class="lang-js">abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Star</span> </span>{
    abstract answerPhone(): <span class="hljs-keyword">void</span>;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Angelababy</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Star</span> </span>{
    public available: boolean = <span class="hljs-literal">true</span>;
    answerPhone(): <span class="hljs-keyword">void</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ä½ å¥½,æˆ‘æ˜¯Angelababy.'</span>);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AngelababyAgent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Star</span> </span>{
    <span class="hljs-keyword">constructor</span>(private angelababy: Angelababy) {
        <span class="hljs-keyword">super</span>();
    }
    answerPhone(): <span class="hljs-keyword">void</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ä½ å¥½,æˆ‘æ˜¯Angelababyçš„ç»çºªäºº.'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.angelababy.available) {
            <span class="hljs-keyword">this</span>.angelababy.answerPhone();
        }
    }
}
<span class="hljs-keyword">let</span> angelababyAgent = <span class="hljs-keyword">new</span> AngelababyAgent(<span class="hljs-keyword">new</span> Angelababy());
angelababyAgent.answerPhone();
</code></pre>
<h4 id="t818.3 åœºæ™¯">8.3 åœºæ™¯ <a href="#t818.3 åœºæ™¯"> # </a></h4>
<h5 id="t828.3.1 äº‹ä»¶å§”æ‰˜ä»£ç†">8.3.1 äº‹ä»¶å§”æ‰˜ä»£ç† <a href="#t828.3.1 äº‹ä»¶å§”æ‰˜ä»£ç†"> # </a></h5>
<ul>
<li>äº‹ä»¶æ•è·æŒ‡çš„æ˜¯ä»documentåˆ°è§¦å‘äº‹ä»¶çš„é‚£ä¸ªèŠ‚ç‚¹ï¼Œå³è‡ªä¸Šè€Œä¸‹çš„å»è§¦å‘äº‹ä»¶</li>
<li>äº‹ä»¶å†’æ³¡æ˜¯è‡ªä¸‹è€Œä¸Šçš„å»è§¦å‘äº‹ä»¶</li>
<li>ç»‘å®šäº‹ä»¶æ–¹æ³•çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå°±æ˜¯æ§åˆ¶äº‹ä»¶è§¦å‘é¡ºåºæ˜¯å¦ä¸ºäº‹ä»¶æ•è·ã€‚trueä¸ºäº‹ä»¶æ•è·ï¼›falseä¸ºäº‹ä»¶å†’æ³¡,é»˜è®¤falseã€‚</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/captureevent.jpg" alt="captureevent"></p>
<pre><code class="lang-js">&lt;body&gt;
    &lt;ul id="list"&gt;
        &lt;li&gt;1&lt;/li&gt;
        &lt;li&gt;2&lt;/li&gt;
        &lt;li&gt;3&lt;/li&gt;
    &lt;/ul&gt;
&lt;script&gt;
  let list = document.querySelector('#list');
  list.addEventListener('click',event=&gt;{
       alert(event.target.innerHTML);
  });     
&lt;/script&gt;    
&lt;/body&gt;
</code></pre>
<h5 id="t838.3.2 è™šæ‹Ÿä»£ç†(å›¾ç‰‡é¢„åŠ è½½)">8.3.2 è™šæ‹Ÿä»£ç†(å›¾ç‰‡é¢„åŠ è½½) <a href="#t838.3.2 è™šæ‹Ÿä»£ç†(å›¾ç‰‡é¢„åŠ è½½)"> # </a></h5>
<ul>
<li><a href="http://img.zhufengpeixun.cn/bg-images.zip">bg-images</a></li>
</ul>
<h6 id="t848.3.2.1 app.js">8.3.2.1 app.js <a href="#t848.3.2.1 app.js"> # </a></h6>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> express=<span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">let</span> path=<span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)
<span class="hljs-keyword">let</span> app=express();
app.get(<span class="hljs-string">'/images/loading.gif'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req,res</span>) </span>{
    res.sendFile(path.join(__dirname,req.path));
});
app.get(<span class="hljs-string">'/images/:name'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req,res</span>) </span>{
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        res.sendFile(path.join(__dirname,req.path));
    }, <span class="hljs-number">2000</span>);
});
app.get(<span class="hljs-string">'/'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req,res</span>) </span>{
    res.sendFile(path.resolve(<span class="hljs-string">'index.html'</span>));
});
app.listen(<span class="hljs-number">8080</span>);
</code></pre>
<h6 id="t858.3.2.2 index.html">8.3.2.2 index.html <a href="#t858.3.2.2 index.html"> # </a></h6>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.bg-container</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">600px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">100px</span> auto;
        }

        <span class="hljs-selector-class">.bg-container</span> <span class="hljs-selector-id">#bg-image</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"background"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg1.jpg"</span>&gt;</span>èƒŒæ™¯1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg2.jpg"</span>&gt;</span>èƒŒæ™¯2<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bg-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"bg-image"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/bg1.jpg"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">let</span> container = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#background'</span>);

        <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BackgroundImage</span> </span>{
            <span class="hljs-keyword">constructor</span>() {
                <span class="hljs-keyword">this</span>.bgImage = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#bg-image'</span>);
            }
            setSrc(src) {
                <span class="hljs-keyword">this</span>.bgImage.src = src;
            }
        }
        <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadingBackgroundImage</span> </span>{ 
             <span class="hljs-keyword">static</span> LOADING_URL= <span class="hljs-string">`/images/loading.gif`</span>;
            <span class="hljs-keyword">constructor</span>() {
                <span class="hljs-keyword">this</span>.backgroundImage = <span class="hljs-keyword">new</span> BackgroundImage();
            }
            setSrc(src) {
                <span class="hljs-keyword">this</span>.backgroundImage.setSrc(LoadingBackgroundImage.LOADING_URL);
                <span class="hljs-keyword">let</span> img = <span class="hljs-keyword">new</span> Image();
                img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
                    <span class="hljs-keyword">this</span>.backgroundImage.setSrc(src);
                }
                img.src = src;
            }
        }
        <span class="hljs-keyword">let</span> loadingBackgroundImage = <span class="hljs-keyword">new</span> LoadingBackgroundImage();
        container.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
            <span class="hljs-keyword">let</span> src = event.target.dataset.src;
            loadingBackgroundImage.setSrc(src + <span class="hljs-string">'?ts='</span> + <span class="hljs-built_in">Date</span>.now());
        });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h5 id="t868.3.3 è™šæ‹Ÿä»£ç†(å›¾ç‰‡æ‡’åŠ è½½)">8.3.3 è™šæ‹Ÿä»£ç†(å›¾ç‰‡æ‡’åŠ è½½) <a href="#t868.3.3 è™šæ‹Ÿä»£ç†(å›¾ç‰‡æ‡’åŠ è½½)"> # </a></h5>
<ul>
<li>å½“å‰å¯è§†åŒºåŸŸçš„é«˜åº¦ <code>window.innerHeight || document.documentElement.clientHeight</code></li>
<li>å…ƒç´ è·ç¦»å¯è§†åŒºåŸŸé¡¶éƒ¨çš„é«˜åº¦ <code>getBoundingClientRect().top</code></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect">getBoundingClientRect</a></li>
<li>DOMRect å¯¹è±¡åŒ…å«äº†ä¸€ç»„ç”¨äºæè¿°è¾¹æ¡†çš„åªè¯»å±æ€§â€”â€”leftã€topã€right å’Œ bottomï¼Œå•ä½ä¸ºåƒç´ ã€‚é™¤äº† width å’Œ height å¤–çš„å±æ€§éƒ½æ˜¯ç›¸å¯¹äºè§†å£çš„å·¦ä¸Šè§’ä½ç½®è€Œè¨€çš„</li>
</ul>
<h6 id="t878.3.3.1 index.html">8.3.3.1 index.html <a href="#t878.3.3.1 index.html"> # </a></h6>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Lazy-Load<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.image</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#CCC</span>;
        }

        <span class="hljs-selector-class">.image</span> <span class="hljs-selector-tag">img</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg1.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg2.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg1.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg2.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg1.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg2.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg1.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg2.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg1.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"image"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">"/images/bg2.jpg"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> imgs = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'img'</span>);
    <span class="hljs-keyword">const</span> clientHeight = <span class="hljs-built_in">window</span>.innerHeight || <span class="hljs-built_in">document</span>.documentElement.clientHeight;
    <span class="hljs-keyword">let</span> loadedIndex = <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lazyload</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = loadedIndex; i &lt; imgs.length; i++) {
            <span class="hljs-keyword">if</span> (clientHeight - imgs[i].getBoundingClientRect().top &gt; <span class="hljs-number">0</span>) {
                imgs[i].src = imgs[i].dataset.src;
                loadedIndex = i + <span class="hljs-number">1</span>;
            }
        }
    }
    lazyload();
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'scroll'</span>, lazyload, <span class="hljs-literal">false</span>);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h5 id="t888.3.4 ç¼“å­˜ä»£ç†">8.3.4 ç¼“å­˜ä»£ç† <a href="#t888.3.4 ç¼“å­˜ä»£ç†"> # </a></h5>
<ul>
<li>æœ‰äº›æ—¶å€™å¯ä»¥ç”¨ç©ºé—´æ¢æ—¶é—´</li>
<li>ä¸€ä¸ªæ­£æ•´æ•°çš„é˜¶ä¹˜ï¼ˆfactorialï¼‰æ˜¯æ‰€æœ‰å°äºåŠç­‰äºè¯¥æ•°çš„æ­£æ•´æ•°çš„ç§¯ï¼Œå¹¶ä¸”0çš„é˜¶ä¹˜ä¸º1</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> factorial = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">f</span>(<span class="hljs-params">num</span>) </span>{
    <span class="hljs-keyword">if</span> (num === <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> (num * f(num - <span class="hljs-number">1</span>));
    }
}

<span class="hljs-keyword">const</span> proxy = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">fn</span>) </span>{
    <span class="hljs-keyword">const</span> cache = {};  <span class="hljs-comment">// ç¼“å­˜å¯¹è±¡</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">num</span>) </span>{
        <span class="hljs-keyword">if</span> (num <span class="hljs-keyword">in</span> cache) {
            <span class="hljs-keyword">return</span> cache[num];   <span class="hljs-comment">// ä½¿ç”¨ç¼“å­˜ä»£ç†</span>
        }
        <span class="hljs-keyword">return</span> cache[num] = fn.call(<span class="hljs-keyword">this</span>, num);
    }
}

<span class="hljs-keyword">const</span> proxyFactorial = proxy(factorial);
<span class="hljs-built_in">console</span>.log(proxyFactorial(<span class="hljs-number">5</span>));
<span class="hljs-built_in">console</span>.log(proxyFactorial(<span class="hljs-number">5</span>));
<span class="hljs-built_in">console</span>.log(proxyFactorial(<span class="hljs-number">5</span>));
</code></pre>
<ul>
<li>æ–æ³¢é‚£å¥‘æ•°åˆ—(Fibonacci sequence)æŒ‡çš„æ˜¯è¿™æ ·ä¸€ä¸ªæ•°åˆ—ï¼š1ã€1ã€2ã€3ã€5ã€8ã€13ã€21ã€34ã€‚åœ¨æ•°å­¦ä¸Šï¼Œæ–æ³¢é‚£å¥‘æ•°åˆ—ä»¥å¦‚ä¸‹è¢«ä»¥é€’æ¨çš„æ–¹æ³•å®šä¹‰ï¼šF(1)=1,F(2)=1,F(n)=F(n-1)+F(n-2)ï¼ˆn&gt;=3ï¼ŒnâˆˆN*ï¼‰</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fib</span>(<span class="hljs-params">n</span>) </span>{
    count++;
    <span class="hljs-keyword">return</span> n &lt;= <span class="hljs-number">2</span> ? <span class="hljs-number">1</span> : fib(n - <span class="hljs-number">1</span>) + fib(n - <span class="hljs-number">2</span>);
}
<span class="hljs-keyword">var</span> result = fib(<span class="hljs-number">10</span>);
<span class="hljs-built_in">console</span>.log(result, count);<span class="hljs-comment">//55 110</span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> fibWithCache = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> cache = {};
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fib</span>(<span class="hljs-params">n</span>) </span>{
        count++;
        <span class="hljs-keyword">if</span> (cache[n]) {
            <span class="hljs-keyword">return</span> cache[n];
        }
        <span class="hljs-keyword">let</span> result = n &lt;= <span class="hljs-number">2</span> ? <span class="hljs-number">1</span> : fib(n - <span class="hljs-number">1</span>) + fib(n - <span class="hljs-number">2</span>);
        cache[n] = result;
        <span class="hljs-keyword">return</span> result;
    }
    <span class="hljs-keyword">return</span> fib;
})();
<span class="hljs-keyword">var</span> result = fibWithCache(<span class="hljs-number">10</span>);
<span class="hljs-built_in">console</span>.log(result, count);<span class="hljs-comment">//55 17</span>
</code></pre>
<h5 id="t898.3.5 é˜²æŠ–ä»£ç†">8.3.5 é˜²æŠ–ä»£ç† <a href="#t898.3.5 é˜²æŠ–ä»£ç†"> # </a></h5>
<ul>
<li>é€šè¿‡é˜²æŠ–ä»£ç†ä¼˜åŒ–å¯ä»¥æŠŠå¤šæ¬¡è¯·æ±‚åˆå¹¶ä¸ºä¸€æ¬¡ï¼Œæé«˜æ€§èƒ½</li>
<li>èŠ‚æµä¸é˜²æŠ–éƒ½æ˜¯ä¸ºäº†å‡å°‘é¢‘ç¹è§¦å‘äº‹ä»¶å›è°ƒ</li>
<li>èŠ‚æµ(Throttle)æ˜¯åœ¨æŸæ®µæ—¶é—´å†…ä¸ç®¡è§¦å‘äº†å¤šå°‘æ¬¡å›è°ƒéƒ½åªè®¤ç¬¬ä¸€ä¸ªï¼Œå¹¶åœ¨ç¬¬ä¸€æ¬¡ç»“æŸåæ‰§è¡Œå›è°ƒ</li>
<li>é˜²æŠ–(Debounce)å°±æ˜¯åœ¨æŸæ®µæ—¶é—´ä¸ç®¡è§¦å‘äº†å¤šå°‘å›è°ƒéƒ½åªçœ‹æœ€åä¸€ä¸ª</li>
</ul>
<h6 id="t908.3.5.1 èŠ‚æµ">8.3.5.1 èŠ‚æµ <a href="#t908.3.5.1 èŠ‚æµ"> # </a></h6>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-id">#container</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid red;
            <span class="hljs-attribute">overflow</span>: auto;
        }

        <span class="hljs-selector-id">#container</span> <span class="hljs-selector-class">.content</span> {
            <span class="hljs-attribute">height</span>: <span class="hljs-number">4000px</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throttle</span>(<span class="hljs-params">callback, interval</span>) </span>{
            <span class="hljs-keyword">let</span> last;
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">let</span> context = <span class="hljs-keyword">this</span>;
                <span class="hljs-keyword">let</span> args = <span class="hljs-built_in">arguments</span>;
                <span class="hljs-keyword">let</span> now = <span class="hljs-built_in">Date</span>.now();
                <span class="hljs-keyword">if</span> (last) {
                    <span class="hljs-keyword">if</span> (now - last &gt;= interval) {
                        last = now;
                        callback.apply(context, args);
                    }
                } <span class="hljs-keyword">else</span> {
                    callback.apply(context, args);
                    last = now;
                }

            }
        }
        <span class="hljs-keyword">let</span> lastTime = <span class="hljs-built_in">Date</span>.now();
        <span class="hljs-keyword">const</span> throttle_scroll = throttle(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'è§¦å‘äº†æ»šåŠ¨äº‹ä»¶'</span>, (<span class="hljs-built_in">Date</span>.now() - lastTime) / <span class="hljs-number">1000</span>);
        }, <span class="hljs-number">1000</span>);
        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'container'</span>).addEventListener(<span class="hljs-string">'scroll'</span>, throttle_scroll);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h6 id="t918.3.5.2 é˜²æŠ–">8.3.5.2 é˜²æŠ– <a href="#t918.3.5.2 é˜²æŠ–"> # </a></h6>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-id">#container</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid red;
            <span class="hljs-attribute">overflow</span>: auto;
        }

        <span class="hljs-selector-id">#container</span> <span class="hljs-selector-class">.content</span> {
            <span class="hljs-attribute">height</span>: <span class="hljs-number">4000px</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"content"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throttle</span>(<span class="hljs-params">callback, delay</span>) </span>{
            <span class="hljs-keyword">let</span> timer;
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                <span class="hljs-keyword">let</span> context = <span class="hljs-keyword">this</span>;
                <span class="hljs-keyword">let</span> args = <span class="hljs-built_in">arguments</span>;
                <span class="hljs-keyword">if</span> (timer)
                    clearTimeout(timer);
                timer = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
                    callback.apply(context, args);
                }, delay);
            }
        }
        <span class="hljs-keyword">let</span> lastTime = <span class="hljs-built_in">Date</span>.now();
        <span class="hljs-keyword">const</span> throttle_scroll = throttle(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'è§¦å‘äº†æ»šåŠ¨äº‹ä»¶'</span>, (<span class="hljs-built_in">Date</span>.now() - lastTime) / <span class="hljs-number">1000</span>);
        }, <span class="hljs-number">1000</span>);
        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'container'</span>).addEventListener(<span class="hljs-string">'scroll'</span>, throttle_scroll);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h6 id="t928.3.5.3 æœªé˜²æŠ–">8.3.5.3 æœªé˜²æŠ– <a href="#t928.3.5.3 æœªé˜²æŠ–"> # </a></h6>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"todos"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">let</span> todos = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#todos'</span>);
    <span class="hljs-built_in">window</span>.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        fetch(<span class="hljs-string">'/todos'</span>).then(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>res.json()).then(<span class="hljs-function"><span class="hljs-params">response</span>=&gt;</span>{
            todos.innerHTML = response.map(<span class="hljs-function"><span class="hljs-params">item</span>=&gt;</span><span class="hljs-string">`&lt;li "&gt;&lt;input value="<span class="hljs-subst">${item.id}</span>" type="checkbox" <span class="hljs-subst">${item.completed?<span class="hljs-string">"checked"</span>:<span class="hljs-string">""</span>}</span>/&gt;<span class="hljs-subst">${item.text}</span>&lt;/li&gt;`</span>).join(<span class="hljs-string">''</span>);
        });
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggle</span>(<span class="hljs-params">id</span>)</span>{
       fetch(<span class="hljs-string">`/toggle/<span class="hljs-subst">${id}</span>`</span>).then(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>res.json()).then(<span class="hljs-function"><span class="hljs-params">response</span>=&gt;</span>{
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'response'</span>,response);
        });
    }
    todos.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{
        <span class="hljs-keyword">let</span> checkbox = event.target;
        <span class="hljs-keyword">let</span> id = checkbox.value;
        toggle(id);
    });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</code></pre>
<p>app.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> express=<span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">let</span> app=express();
app.use(express.static(__dirname));
<span class="hljs-keyword">let</span> todos=[
    {<span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<span class="hljs-attr">text</span>: <span class="hljs-string">'a'</span>,<span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>},
    {<span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,<span class="hljs-attr">text</span>: <span class="hljs-string">'b'</span>,<span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>},
    {<span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,<span class="hljs-attr">text</span>: <span class="hljs-string">'c'</span>,<span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>},
];
app.get(<span class="hljs-string">'/todos'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req,res</span>) </span>{
    res.json(todos);
});
app.get(<span class="hljs-string">'/toggle/:id'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req,res</span>) </span>{
    <span class="hljs-keyword">let</span> id=req.params.id;
    todos = todos.map(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (item.id==id) {
            item.completed=!item.completed;
        }
        <span class="hljs-keyword">return</span> item;
    });
    res.json({<span class="hljs-attr">code</span>:<span class="hljs-number">0</span>});
});
app.listen(<span class="hljs-number">8080</span>);
</code></pre>
<h6 id="t938.3.5.4 é˜²æŠ–">8.3.5.4 é˜²æŠ– <a href="#t938.3.5.4 é˜²æŠ–"> # </a></h6>
<p>todos.html</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"todos"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">let</span> todos = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#todos'</span>);
    <span class="hljs-built_in">window</span>.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        fetch(<span class="hljs-string">'/todos'</span>).then(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>res.json()).then(<span class="hljs-function"><span class="hljs-params">response</span>=&gt;</span>{
            todos.innerHTML = response.map(<span class="hljs-function"><span class="hljs-params">item</span>=&gt;</span><span class="hljs-string">`&lt;li "&gt;&lt;input value="<span class="hljs-subst">${item.id}</span>" type="checkbox" <span class="hljs-subst">${item.completed?<span class="hljs-string">"checked"</span>:<span class="hljs-string">""</span>}</span>/&gt;<span class="hljs-subst">${item.text}</span>&lt;/li&gt;`</span>).join(<span class="hljs-string">''</span>);
        });
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggle</span>(<span class="hljs-params">id</span>)</span>{
       fetch(<span class="hljs-string">`/toggle/<span class="hljs-subst">${id}</span>`</span>).then(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>res.json()).then(<span class="hljs-function"><span class="hljs-params">response</span>=&gt;</span>{
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'response'</span>,response);
        });
    }
    <span class="hljs-keyword">let</span> LazyToggle = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>)</span>{
        <span class="hljs-keyword">let</span> ids = [];
        <span class="hljs-keyword">let</span> timer;
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">id</span>)</span>{
            ids.push(id);
            <span class="hljs-keyword">if</span>(timer){
               clearTimeout(timer);
            }
            timer = setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
                toggle(ids.join(<span class="hljs-string">','</span>));
                ids = <span class="hljs-literal">null</span>;
                clearTimeout(timer);
                timer = <span class="hljs-literal">null</span>;
            },<span class="hljs-number">2000</span>);
        }
    })();
    todos.addEventListener(<span class="hljs-string">'click'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{
        <span class="hljs-keyword">let</span> checkbox = event.target;
        <span class="hljs-keyword">let</span> id = checkbox.value;
        LazyToggle(id);
    });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>app.js</p>
<pre><code class="lang-js">app.get(<span class="hljs-string">'/toggle/:ids'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req,res</span>) </span>{
    <span class="hljs-keyword">let</span> ids=req.params.ids;
    ids=ids.split(<span class="hljs-string">','</span>).map(<span class="hljs-function"><span class="hljs-params">item</span>=&gt;</span><span class="hljs-built_in">parseInt</span>(item));
    todos = todos.map(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (ids.includes(item.id)) {
            item.completed=!item.completed;
        }
        <span class="hljs-keyword">return</span> item;
    });
    res.json({<span class="hljs-attr">code</span>:<span class="hljs-number">0</span>});
});
</code></pre>
<h5 id="t948.3.6 ä»£ç†è·¨åŸŸ">8.3.6 ä»£ç†è·¨åŸŸ <a href="#t948.3.6 ä»£ç†è·¨åŸŸ"> # </a></h5>
<h6 id="t958.3.6.1 æ­£å‘ä»£ç†å’Œåå‘ä»£ç†">8.3.6.1 æ­£å‘ä»£ç†å’Œåå‘ä»£ç† <a href="#t958.3.6.1 æ­£å‘ä»£ç†å’Œåå‘ä»£ç†"> # </a></h6>
<ul>
<li>æ­£å‘ä»£ç†çš„å¯¹è±¡æ˜¯å®¢æˆ·ç«¯,æœåŠ¡å™¨ç«¯çœ‹ä¸åˆ°çœŸæ­£çš„å®¢æˆ·ç«¯</li>
<li>é€šè¿‡å…¬å¸ä»£ç†æœåŠ¡å™¨ä¸Šç½‘</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/positiveproxy.jpg" alt="positiveproxy"></p>
<ul>
<li>åå‘ä»£ç†çš„å¯¹è±¡çš„æœåŠ¡ç«¯,å®¢æˆ·ç«¯çœ‹ä¸åˆ°çœŸæ­£çš„æœåŠ¡ç«¯</li>
<li>nginxä»£ç†åº”ç”¨æœåŠ¡å™¨</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/fanproxy.jpg" alt="fanproxy"></p>
<p>proxy-server.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);
<span class="hljs-keyword">const</span> httpProxy = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http-proxy'</span>);
<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ªä»£ç†æœåŠ¡</span>
<span class="hljs-keyword">const</span> proxy = httpProxy.createProxyServer();
<span class="hljs-comment">//åˆ›å»ºhttpæœåŠ¡å™¨å¹¶ç›‘å¬8888ç«¯å£</span>
<span class="hljs-keyword">let</span> server = http.createServer(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
    <span class="hljs-comment">//å°†ç”¨æˆ·çš„è¯·æ±‚è½¬å‘åˆ°æœ¬åœ°9999ç«¯å£ä¸Š</span>
    proxy.web(req, res, {
        <span class="hljs-attr">target</span>: <span class="hljs-string">'http://127.0.0.1:9999'</span>
    });
    <span class="hljs-comment">//ç›‘å¬ä»£ç†æœåŠ¡é”™è¯¯</span>
    proxy.on(<span class="hljs-string">'error'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
        <span class="hljs-built_in">console</span>.log(err);
    });
});
server.listen(<span class="hljs-number">8888</span>, <span class="hljs-string">'0.0.0.0'</span>);
</code></pre>
<p>real-server.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);
<span class="hljs-keyword">let</span> server = http.createServer(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
    res.end(<span class="hljs-string">'9999'</span>);
});
server.listen(<span class="hljs-number">9999</span>, <span class="hljs-string">'0.0.0.0'</span>);
</code></pre>
<h6 id="t968.3.6.2 ä»£ç†è·¨åŸŸ">8.3.6.2 ä»£ç†è·¨åŸŸ <a href="#t968.3.6.2 ä»£ç†è·¨åŸŸ"> # </a></h6>
<ul>
<li>nginxä»£ç†è·¨åŸŸ</li>
<li><code>webpack-dev-server</code>ä»£ç†è·¨åŸŸ</li>
<li>å®¢æˆ·ç«¯ä»£ç†è·¨åŸŸ</li>
<li>å½“å‰çš„æœåŠ¡å¯åŠ¨åœ¨origin(3000ç«¯å£)ä¸Šï¼Œä½†æ˜¯è°ƒç”¨çš„æ¥å£åœ¨target(4000ç«¯å£)ä¸Š</li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage">postMessage</a>æ–¹æ³•å¯ä»¥å®‰å…¨åœ°å®ç°è·¨æºé€šä¿¡<ul>
<li><code>otherWindow</code>:å…¶ä»–çª—å£çš„ä¸€ä¸ªå¼•ç”¨ message:å°†è¦å‘é€åˆ°å…¶ä»–windowçš„æ•°æ®  </li>
<li><code>message</code> å°†è¦å‘é€åˆ°å…¶ä»–windowçš„æ•°æ®  </li>
<li><code>targetOrigin</code>é€šè¿‡çª—å£çš„originå±æ€§æ¥æŒ‡å®šå“ªäº›çª—å£èƒ½æ¥æ”¶åˆ°æ¶ˆæ¯äº‹ä»¶ï¼Œå…¶å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²"*"ï¼ˆè¡¨ç¤ºæ— é™åˆ¶ï¼‰æˆ–è€…ä¸€ä¸ªURI</li>
</ul>
</li>
</ul>
<pre><code class="lang-js">otherWindow.postMessage(message, targetOrigin, [transfer]);
</code></pre>
<ul>
<li>data ä»å…¶ä»–<code>window</code>ä¸­ä¼ é€’è¿‡æ¥çš„å¯¹è±¡</li>
<li>origin è°ƒç”¨<code>postMessage</code>æ—¶æ¶ˆæ¯å‘é€æ–¹çª—å£çš„<code>origin</code></li>
<li>source å¯¹å‘é€æ¶ˆæ¯çš„çª—å£å¯¹è±¡çš„å¼•ç”¨</li>
</ul>
<pre><code class="lang-js"><span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"message"</span>, receiveMessage, <span class="hljs-literal">false</span>);
</code></pre>
<p>origin.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> express=<span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">let</span> app=express();
app.use(express.static(__dirname));
app.listen(<span class="hljs-number">3000</span>);
</code></pre>
<p>target.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">let</span> app = express();
<span class="hljs-keyword">let</span> bodyParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">'body-parser'</span>);
app.use(bodyParser.urlencoded({ <span class="hljs-attr">extended</span>: <span class="hljs-literal">true</span> }));
app.use(express.static(__dirname));
<span class="hljs-keyword">let</span> users = [];
app.post(<span class="hljs-string">'/register'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) </span>{
    <span class="hljs-keyword">let</span> body = req.body;
    <span class="hljs-keyword">let</span> target = body.target;
    <span class="hljs-keyword">let</span> callback = body.callback;
    <span class="hljs-keyword">let</span> username = body.username;
    <span class="hljs-keyword">let</span> password = body.password;
    <span class="hljs-keyword">let</span> user = { username, password };
    <span class="hljs-keyword">let</span> id = users.length == <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : users[users.length - <span class="hljs-number">1</span>].id + <span class="hljs-number">1</span>;
    user.id = id;
    users.push(user);
    res.status(<span class="hljs-number">302</span>);
    res.header(<span class="hljs-string">'Location'</span>, <span class="hljs-string">`<span class="hljs-subst">${target}</span>?callback=<span class="hljs-subst">${callback}</span>&amp;args=<span class="hljs-subst">${id}</span>`</span>);
    res.end();
});
app.listen(<span class="hljs-number">4000</span>);
</code></pre>
<p>reg.html</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
        <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
            <span class="hljs-built_in">console</span>.log(event.data);

            <span class="hljs-keyword">if</span> (event.data.receiveId) {
                alert(<span class="hljs-string">'ç”¨æˆ·ID='</span> + event.data.receiveId);
            }
        })
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"proxyIframe"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"proxyIframe"</span> <span class="hljs-attr">frameborder</span>=<span class="hljs-string">"0"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">iframe</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"http://localhost:4000/register"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"proxyIframe"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"callback"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"receiveId"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"target"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"http://localhost:3000/target.html"</span>&gt;</span>
        ç”¨æˆ·å<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span> /&gt;</span>
        å¯†ç <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"æäº¤"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>target.html</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-built_in">window</span>.onload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">var</span> query = location.search.substr(<span class="hljs-number">1</span>).split(<span class="hljs-string">'&amp;'</span>);
            <span class="hljs-keyword">let</span> callback, args;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, len = query.length; i &lt; len; i++) {
                <span class="hljs-keyword">let</span> item = query[i].split(<span class="hljs-string">'='</span>);
                <span class="hljs-keyword">if</span> (item[<span class="hljs-number">0</span>] == <span class="hljs-string">'callback'</span>) {
                    callback = item[<span class="hljs-number">1</span>];
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item[<span class="hljs-number">0</span>] == <span class="hljs-string">'args'</span>) {
                    args = item[<span class="hljs-number">1</span>];
                }
            }
            <span class="hljs-keyword">try</span> {
                <span class="hljs-built_in">window</span>.parent.postMessage({ [callback]: args }, <span class="hljs-string">'*'</span>);
            } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-built_in">console</span>.log(error);
            }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h5 id="t978.3.7 $.proxy">8.3.7 $.proxy <a href="#t978.3.7 $.proxy"> # </a></h5>
<ul>
<li>æ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªæ–°å‡½æ•°å§‹ç»ˆä¿æŒäº†ç‰¹å®šçš„ä¸Šä¸‹æ–‡è¯­å¢ƒã€‚</li>
<li><code>jQuery.proxy( function, context )</code> functionä¸ºæ‰§è¡Œçš„å‡½æ•°ï¼Œcontentä¸ºå‡½æ•°çš„ä¸Šä¸‹æ–‡thiså€¼ä¼šè¢«è®¾ç½®æˆè¿™ä¸ªobjectå¯¹è±¡</li>
</ul>
<pre><code class="lang-js">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
    &lt;title&gt;jquery proxy&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;button id="btn"&gt;ç‚¹æˆ‘å˜çº¢&lt;/button&gt;
    &lt;script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"&gt;&lt;/script&gt;
    &lt;script&gt;
        let btn = document.getElementById('btn');
        btn.addEventListener('click', function () {
            setTimeout($.proxy((function () {
                $(this).css('color', 'red');
            }), this), 1000);
        });    
    &lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">proxy</span>(<span class="hljs-params">fn, context</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
       <span class="hljs-keyword">return</span> fn.call(context, <span class="hljs-built_in">arguments</span>);
    }
}
</code></pre>
<h5 id="t988.3.8 Proxy">8.3.8 Proxy <a href="#t988.3.8 Proxy"> # </a></h5>
<ul>
<li>Proxy ç”¨äºä¿®æ”¹æŸäº›æ“ä½œçš„é»˜è®¤è¡Œä¸º</li>
<li>Proxy å¯ä»¥ç†è§£æˆï¼Œåœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰æ¶è®¾ä¸€å±‚<code>æ‹¦æˆª</code>,å¤–ç•Œå¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œéƒ½å¿…é¡»å…ˆé€šè¿‡è¿™å±‚æ‹¦æˆªï¼Œå› æ­¤æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥å¯¹å¤–ç•Œçš„è®¿é—®è¿›è¡Œè¿‡æ»¤å’Œæ”¹å†™ã€‚</li>
<li>Proxy è¿™ä¸ªè¯çš„åŸæ„æ˜¯ä»£ç†ï¼Œç”¨åœ¨è¿™é‡Œè¡¨ç¤ºç”±å®ƒæ¥<code>ä»£ç†</code>æŸäº›æ“ä½œï¼Œå¯ä»¥è¯‘ä¸º<code>ä»£ç†å™¨</code></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy">Proxy</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">defineProperty</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> wang={
    <span class="hljs-attr">name</span>: <span class="hljs-string">'wanglaoshi'</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">29</span>,
    <span class="hljs-attr">height</span>:<span class="hljs-number">165</span>
}
<span class="hljs-keyword">let</span> wangMama=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Proxy</span>(wang,{
    <span class="hljs-keyword">get</span>(target,key) {
        <span class="hljs-keyword">if</span> (key == <span class="hljs-string">'age'</span>) {
            <span class="hljs-keyword">return</span> wang.age<span class="hljs-number">-1</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key == <span class="hljs-string">'height'</span>) {
            <span class="hljs-keyword">return</span> wang.height<span class="hljs-number">-5</span>;
        }
        <span class="hljs-keyword">return</span> target[key];
    },
    <span class="hljs-keyword">set</span>(target,key,val) {
        <span class="hljs-keyword">if</span> (key == <span class="hljs-string">'boyfriend'</span>) {
            <span class="hljs-keyword">let</span> boyfriend=val;
            <span class="hljs-keyword">if</span> (boyfriend.age&gt;<span class="hljs-number">40</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'å¤ªè€'</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (boyfriend.salary&lt;<span class="hljs-number">20000</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'å¤ªç©·'</span>);
            } <span class="hljs-keyword">else</span> {
                target[key]=val;
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
        }
    }
});
<span class="hljs-built_in">console</span>.log(wangMama.age);
<span class="hljs-built_in">console</span>.log(wangMama.height);
wangMama.boyfriend={
    <span class="hljs-attr">age</span>: <span class="hljs-number">41</span>,
    <span class="hljs-attr">salary</span>:<span class="hljs-number">3000</span>
}
</code></pre>
<h5 id="t998.3.9 Vue2å’ŒVue3">8.3.9 Vue2å’ŒVue3 <a href="#t998.3.9 Vue2å’ŒVue3"> # </a></h5>
<ul>
<li>Vue2 ä¸­çš„å˜åŒ–ä¾¦æµ‹å®ç°å¯¹ Object åŠ Array åˆ†åˆ«è¿›è¡Œäº†ä¸åŒçš„å¤„ç†,Object ä½¿ç”¨äº†
<code>Object.defineProperty API</code>,<code>Array</code>ä½¿ç”¨äº†æ‹¦æˆªå™¨å¯¹ <code>Array</code> åŸå‹ä¸Šçš„èƒ½å¤Ÿæ”¹å˜æ•°æ®çš„æ–¹æ³•è¿›è¡Œæ‹¦æˆªã€‚è™½ç„¶ä¹Ÿå®ç°äº†æ•°æ®çš„å˜åŒ–ä¾¦æµ‹ï¼Œä½†å­˜åœ¨å¾ˆå¤šå±€é™ ï¼Œæ¯”å¦‚å¯¹è±¡æ–°å¢å±æ€§æ— æ³•è¢«ä¾¦æµ‹ï¼Œä»¥åŠé€šè¿‡æ•°ç»„ä¸‹è¾¹ä¿®æ”¹æ•°ç»„å†…å®¹ï¼Œä¹Ÿå› æ­¤åœ¨ Vue2 ä¸­ç»å¸¸ä¼šä½¿ç”¨åˆ° <code>$set</code> è¿™ä¸ªæ–¹æ³•å¯¹æ•°æ®ä¿®æ”¹ï¼Œä»¥ä¿è¯ä¾èµ–æ›´æ–°ã€‚</li>
<li>Vue3 ä¸­ä½¿ç”¨äº† es6 çš„ <code>Proxy API</code>å¯¹æ•°æ®ä»£ç†ï¼Œæ²¡æœ‰åƒ <code>Vue2</code> ä¸­å¯¹åŸæ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œåªæ˜¯åŠ äº†ä»£ç†åŒ…è£…ï¼Œå› æ­¤é¦–å…ˆæ€§èƒ½ä¸Šä¼šæœ‰æ‰€æ”¹å–„ã€‚å…¶æ¬¡è§£å†³äº† <code>Vue2</code> ä¸­å˜åŒ–ä¾¦æµ‹çš„å±€é™æ€§ï¼Œå¯ä»¥ä¸ä½¿ç”¨ <code>$set</code> æ–°å¢çš„å¯¹è±¡å±æ€§åŠé€šè¿‡ä¸‹æ ‡ä¿®æ”¹æ•°ç»„éƒ½èƒ½è¢«ä¾¦æµ‹åˆ°ã€‚</li>
</ul>
<h5 id="t1008.3.10">8.3.10 <a href="#t1008.3.10"> # </a></h5>
<ul>
<li>ä»£ç†æ¨¡å¼ VS é€‚é…å™¨æ¨¡å¼ é€‚é…å™¨æä¾›ä¸åŒæ¥å£ï¼Œä»£ç†æ¨¡å¼æä¾›ä¸€æ¨¡ä¸€æ ·çš„æ¥å£</li>
<li>ä»£ç†æ¨¡å¼ VS è£…é¥°å™¨æ¨¡å¼ è£…é¥°å™¨æ¨¡å¼åŸæ¥çš„åŠŸèƒ½ä¸å˜è¿˜å¯ä»¥ä½¿ç”¨ï¼Œä»£ç†æ¨¡å¼æ”¹å˜åŸæ¥çš„åŠŸèƒ½</li>
</ul>
<h2 id="t1019.è§‚å¯Ÿè€…æ¨¡å¼">9.è§‚å¯Ÿè€…æ¨¡å¼ <a href="#t1019.è§‚å¯Ÿè€…æ¨¡å¼"> # </a></h2>
<ul>
<li>è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªç›®æ ‡å¯¹è±¡ï¼Œå½“è¿™ä¸ªç›®æ ‡å¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿å®ƒä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°</li>
<li>åŒåä¸€åŠ å…¥è´­ç‰©è½¦</li>
</ul>
<h4 id="t1029.1 ç±»å›¾">9.1 ç±»å›¾ <a href="#t1029.1 ç±»å›¾"> # </a></h4>
<ul>
<li>ä¸»é¢˜å¯¹è±¡(Subject) è¯¥è§’è‰²åˆç§°ä¸ºè¢«è§‚å¯Ÿè€…,å¯ä»¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡,å®ƒå°†æœ‰å…³çŠ¶æ€å­˜å…¥å…·ä½“è§‚å¯Ÿè€…å¯¹è±¡ï¼Œåœ¨å…·ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œç»™æ‰€æœ‰ç™»è®°è¿‡(å…³è”äº†è§‚å¯Ÿå…³ç³»)çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥</li>
<li>è§‚å¯Ÿè€…(Observer)è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªæ¥æ”¶é€šçŸ¥çš„æ¥å£(update),åœ¨å¾—åˆ°ä¸»é¢˜çš„é€šçŸ¥æ—¶æ›´æ–°è‡ªå·±</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/teacherobserver.png" alt="teacherobserver"></p>
<h4 id="t1039.2 ä»£ç ">9.2 ä»£ç  <a href="#t1039.2 ä»£ç "> # </a></h4>
<pre><code class="lang-js">abstract <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>{
    <span class="hljs-keyword">constructor</span>(public teacher: Teacher) { }
    public abstract update();
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Xueba</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Student</span> </span>{
    public update() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.teacher.getState() + <span class="hljs-string">',å­¦éœ¸æŠ¬å¤´ä¸¾æ‰‹'</span>);
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Xuezha</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Student</span> </span>{
    public update() {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.teacher.getState() + <span class="hljs-string">',å­¦æ¸£ä½å¤´ç¥ˆç¥·'</span>);
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Teacher</span> </span>{
    private students: Student[] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>&lt;Student&gt;();
    public state: string = <span class="hljs-string">'è€å¸ˆè®²è¯¾'</span>
    getState() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state;
    }
    public askQuestion() {
        <span class="hljs-keyword">this</span>.state = <span class="hljs-string">'è€å¸ˆæé—®'</span>;
        <span class="hljs-keyword">this</span>.notifyAllStudents();
    }
    attach(student: Student) {
        <span class="hljs-keyword">this</span>.students.push(student);
    }
    notifyAllStudents() {
        <span class="hljs-keyword">this</span>.students.forEach(<span class="hljs-function"><span class="hljs-params">student</span> =&gt;</span> student.update());
    }
}
<span class="hljs-keyword">let</span> teacher = <span class="hljs-keyword">new</span> Teacher();
teacher.attach(<span class="hljs-keyword">new</span> Xueba(teacher));
teacher.attach(<span class="hljs-keyword">new</span> Xueza(teacher));
teacher.askQuestion();
</code></pre>
<h4 id="t1049.3 åœºæ™¯">9.3 åœºæ™¯ <a href="#t1049.3 åœºæ™¯"> # </a></h4>
<h5 id="t1059.3.1 DOMäº‹ä»¶ç»‘å®š">9.3.1 DOMäº‹ä»¶ç»‘å®š <a href="#t1059.3.1 DOMäº‹ä»¶ç»‘å®š"> # </a></h5>
<p>åŸç”Ÿ</p>
<pre><code class="lang-js">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
    &lt;title&gt;è§‚å¯Ÿè€…æ¨¡å¼&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;button id="btn"&gt;click&lt;/button&gt;
    &lt;script&gt;
        let btn = document.getElementById('btn');
        const handler1 = () =&gt; { console.log(1); }
        const handler2 = () =&gt; { console.log(2); }
        const handler3 = () =&gt; { console.log(3); }
        btn.addEventListener('click', handler1);
        btn.addEventListener('click',handler2);
        btn.addEventListener('click', handler3);
    &lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
<p>jquery</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>è§‚å¯Ÿè€…æ¨¡å¼<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://libs.baidu.com/jquery/2.0.0/jquery.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn"</span>&gt;</span>click<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> handler1 = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> { <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>); }
        <span class="hljs-keyword">const</span> handler2 = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> { <span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>); }
        <span class="hljs-keyword">const</span> handler3 = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> { <span class="hljs-built_in">console</span>.log(<span class="hljs-number">3</span>); }
        $(<span class="hljs-string">'#btn'</span>).on(<span class="hljs-string">'clickMe'</span>, handler1);
        $(<span class="hljs-string">'#btn'</span>).on(<span class="hljs-string">'clickMe'</span>, handler2);
        $(<span class="hljs-string">'#btn'</span>).on(<span class="hljs-string">'clickMe'</span>, handler3);
        $(<span class="hljs-string">'#btn'</span>).trigger(<span class="hljs-string">'clickMe'</span>);
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'================================='</span>);
        $(<span class="hljs-string">'#btn'</span>).off(<span class="hljs-string">'clickMe'</span>, handler2);
        $(<span class="hljs-string">'#btn'</span>).trigger(<span class="hljs-string">'clickMe'</span>);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h5 id="t1069.3.2 Promise">9.3.2 Promise <a href="#t1069.3.2 Promise"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Promise</span> </span>{
    private callbacks: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">Function</span>&gt; = []
    <span class="hljs-keyword">constructor</span>(fn) {
        <span class="hljs-keyword">let</span> resolve = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-keyword">this</span>.callbacks.forEach(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> callback())
        };
        fn(resolve);
    }
    then(callback) {
        <span class="hljs-keyword">this</span>.callbacks.push(callback);
    }
}
<span class="hljs-keyword">let</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>{
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        resolve(<span class="hljs-number">100</span>);
    }, <span class="hljs-number">1000</span>);
});
promise.then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>));
promise.then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>));
</code></pre>
<h5 id="t1079.3.3 callbacks">9.3.3 callbacks <a href="#t1079.3.3 callbacks"> # </a></h5>
<ul>
<li><code>JQuery.Callbacks</code>æ˜¯jQuery1.7+ä¹‹åå¼•å…¥çš„ï¼Œç”¨æ¥è¿›è¡Œå‡½æ•°é˜Ÿåˆ—çš„addã€removeã€fireã€lockç­‰æ“ä½œ</li>
<li>Callbackså¯¹è±¡å…¶å®å°±æ˜¯ä¸€ä¸ªå‡½æ•°é˜Ÿåˆ—ï¼Œè·å¾—Callbackså¯¹è±¡ä¹‹å ï¼Œå°±å¯ä»¥å‘è¿™ä¸ªé›†åˆä¸­å¢åŠ æˆ–è€…åˆ é™¤å‡½æ•°ã€‚addå’ŒremoveåŠŸèƒ½ç›¸åï¼Œå‡½æ•°å‚æ•°æ˜¯ç›¸åŒçš„ï¼Œempty()åˆ é™¤å›è°ƒåˆ—è¡¨ä¸­çš„æ‰€æœ‰å‡½æ•°</li>
</ul>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://libs.baidu.com/jquery/2.0.0/jquery.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">let</span> callbacks = $.Callbacks();

        <span class="hljs-keyword">let</span> a1 = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> alert(<span class="hljs-number">1</span>);
        <span class="hljs-keyword">let</span> a2 = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> alert(<span class="hljs-number">2</span>);
        <span class="hljs-keyword">let</span> a3 = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> alert(<span class="hljs-number">13</span>);
        callbacks.add(a1);
        callbacks.add(a2);
        callbacks.add(a3);
        callbacks.remove(a3);
        callbacks.fire();
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>Callbacks</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Callbacks</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> observers = [];
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">observer</span>) </span>{
        observers.push(observer);
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">remove</span>(<span class="hljs-params">observer</span>) </span>{
        <span class="hljs-keyword">let</span> index = observers.indexOf(observer);
        <span class="hljs-keyword">if</span> (index != <span class="hljs-number">-1</span>)
            observers.splice(index, <span class="hljs-number">1</span>);
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fire</span>(<span class="hljs-params"></span>) </span>{
        observers.forEach(<span class="hljs-function"><span class="hljs-params">observer</span> =&gt;</span> observer());
    }
    <span class="hljs-keyword">return</span> {
        add,
        remove,
        fire
    }
}
</code></pre>
<h5 id="t1089.3.4 EventEmitter">9.3.4 EventEmitter <a href="#t1089.3.4 EventEmitter"> # </a></h5>
<p>è‡ªå®šä¹‰äº‹ä»¶</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> EventEmitter = <span class="hljs-built_in">require</span>(<span class="hljs-string">'events'</span>);
<span class="hljs-keyword">let</span> subject = <span class="hljs-keyword">new</span> EventEmitter();
subject.on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>, name);
});
subject.on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>, name);
});
subject.emit(<span class="hljs-string">'click'</span>, <span class="hljs-string">'zhufeng'</span>);
</code></pre>
<p>events.js</p>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventEmitter</span></span>{
    <span class="hljs-keyword">constructor</span>() {
        <span class="hljs-keyword">this</span>._events={};
    }
    on(type,listener) {
        <span class="hljs-keyword">let</span> listeners=<span class="hljs-keyword">this</span>._events[type];
        <span class="hljs-keyword">if</span> (listeners) {
            listeners.push(listener);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>._events[type]=[listener];
        }
    }
    emit(type) {
        <span class="hljs-keyword">let</span> listeners=<span class="hljs-keyword">this</span>._events[type];
        <span class="hljs-keyword">let</span> args=<span class="hljs-built_in">Array</span>.from(<span class="hljs-built_in">arguments</span>).slice(<span class="hljs-number">1</span>);
        listeners.forEach(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> listener(...args));
    }
}
<span class="hljs-built_in">module</span>.exports = EventEmitter;
</code></pre>
<h5 id="t1099.3.5 æµ">9.3.5 æµ <a href="#t1099.3.5 æµ"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">let</span> rs = fs.createReadStream(<span class="hljs-string">'./1.txt'</span>, { <span class="hljs-attr">highWaterMark</span>: <span class="hljs-number">3</span> });
rs.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
    <span class="hljs-built_in">console</span>.log(data.toString());
});
rs.on(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'end'</span>);
});
</code></pre>
<h5 id="t1109.3.6 httpæœåŠ¡å™¨">9.3.6 httpæœåŠ¡å™¨ <a href="#t1109.3.6 httpæœåŠ¡å™¨"> # </a></h5>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);
<span class="hljs-keyword">let</span> server = http.createServer();
server.on(<span class="hljs-string">'request'</span>, (req, res) =&gt; {
    res.end(<span class="hljs-string">'zhufeng'</span>);
});
server.listen(<span class="hljs-number">3000</span>);
</code></pre>
<h5 id="t1119.3.7 ç”Ÿå‘½å‘¨æœŸå‡½æ•°">9.3.7 ç”Ÿå‘½å‘¨æœŸå‡½æ•° <a href="#t1119.3.7 ç”Ÿå‘½å‘¨æœŸå‡½æ•°"> # </a></h5>
<p><img src="http://img.zhufengpeixun.cn/reactlifecycles.jpg" alt="reactlifecycles"></p>
<p><img src="http://img.zhufengpeixun.cn/vuelifecycles.jpg" alt="vuelifecycles"></p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"root"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">let</span> container = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>);
        <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Component</span> </span>{
            state = { <span class="hljs-attr">number</span>: <span class="hljs-number">0</span> }
            componentWillMount() {
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'componentWillMount'</span>);
            }

            componentDidMount() {
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'componentDidMount'</span>);
            }
            shouldComponentUpdate() {
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'shouldComponentUpdate'</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            componentWillUpdate() {
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'componentWillUpdate'</span>);
            }

            componentDidUpdate() {
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'componentDidUpdate'</span>);
            }
            setState(newState) {
                <span class="hljs-keyword">this</span>.state = { ...this.state, ...newState }
                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.shouldComponentUpdate || (<span class="hljs-keyword">this</span>.shouldComponentUpdate &amp;&amp; <span class="hljs-keyword">this</span>.shouldComponentUpdate())) {
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.componentWillUpdate)
                        <span class="hljs-keyword">this</span>.componentWillUpdate();
                    <span class="hljs-keyword">let</span> content = <span class="hljs-keyword">this</span>.render();
                    container.innerHTML = content;
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.componentDidUpdate)
                        <span class="hljs-keyword">this</span>.componentDidUpdate();
                }
            }
            render() {
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'render'</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state.number;
            }
        }
        render(Component, <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'root'</span>));
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params">Component, container</span>) </span>{

            <span class="hljs-keyword">let</span> component = <span class="hljs-keyword">new</span> Component();
            <span class="hljs-keyword">if</span> (component.componentWillMount)
                component.componentWillMount();
            <span class="hljs-keyword">let</span> content = component.render();
            container.innerHTML = content;
            <span class="hljs-keyword">if</span> (component.componentDidMount)
                component.componentDidMount();

            setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
                component.setState({ <span class="hljs-attr">number</span>: <span class="hljs-number">1</span> });
            }, <span class="hljs-number">3000</span>);
        }

    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h5 id="t1129.3.8 EventBus">9.3.8 EventBus <a href="#t1129.3.8 EventBus"> # </a></h5>
<ul>
<li>å¦‚æœä½ è§‰å¾—ä½¿ç”¨<code>$on</code>ã€<code>$emit</code>ä¸æ–¹ä¾¿,è€Œä½ åˆä¸æ„¿æ„å¼•å…¥<code>vuex</code>,å¯ä»¥ä½¿ç”¨<code>EventBus</code></li>
<li>åœ¨è¦ç›¸äº’é€šä¿¡çš„å…„å¼Ÿç»„ä»¶ä¹‹ä¸­ï¼Œéƒ½å¼•å…¥ä¸€ä¸ªæ–°çš„vueå®ä¾‹ï¼Œç„¶åé€šè¿‡åˆ†åˆ«è°ƒç”¨è¿™ä¸ªå®ä¾‹çš„äº‹ä»¶è§¦å‘å’Œç›‘å¬æ¥å®ç°é€šä¿¡å’Œå‚æ•°ä¼ é€’</li>
</ul>
<p>EventBus.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> Vue <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;  
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> Vue(); 
</code></pre>
<p>ç»„ä»¶A</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> EventBus <span class="hljs-keyword">from</span> <span class="hljs-string">'./EventBus'</span>;  
EventBus.$on(<span class="hljs-string">"customEvent"</span>, name =&gt; {
    <span class="hljs-built_in">console</span>.log(name);
})
</code></pre>
<p>ç»„ä»¶B</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> EventBus <span class="hljs-keyword">from</span> <span class="hljs-string">'./EventBus'</span>;  
EventBus.$emit(<span class="hljs-string">"customEvent"</span>, <span class="hljs-string">'zhufeng'</span>)
</code></pre>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.5.17/vue.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">let</span> EventBus = <span class="hljs-keyword">new</span> Vue();
        EventBus.$on(<span class="hljs-string">"customEvent"</span>, name =&gt; {
            <span class="hljs-built_in">console</span>.log(name);
        })
        EventBus.$emit(<span class="hljs-string">"customEvent"</span>, <span class="hljs-string">'zhufeng'</span>)
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</code></pre>
<h5 id="t1139.3.9 Vueå“åº”å¼">9.3.9 Vueå“åº”å¼ <a href="#t1139.3.9 Vueå“åº”å¼"> # </a></h5>
<ul>
<li>åœ¨ Vue ä¸­ï¼Œæ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰ç›¸åº”çš„ <code>watcher</code> å®ä¾‹å¯¹è±¡ï¼Œå®ƒä¼šåœ¨ç»„ä»¶æ¸²æŸ“çš„è¿‡ç¨‹ä¸­æŠŠå±æ€§è®°å½•ä¸ºä¾èµ–ï¼Œä¹‹åå½“ä¾èµ–é¡¹çš„ <code>setter</code> è¢«è°ƒç”¨æ—¶ï¼Œä¼šé€šçŸ¥ <code>watcher</code> é‡æ–°è®¡ç®—ï¼Œä»è€Œè‡´ä½¿å®ƒå…³è”çš„ç»„ä»¶å¾—ä»¥æ›´æ–°</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/vuereactive.jpg" alt="vuereactive"></p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>vue<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"name"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"age"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">let</span> name = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'name'</span>);
        <span class="hljs-keyword">let</span> age = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'age'</span>);
        <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dep</span> </span>{
            subs = []
            addSub(sub) {
                <span class="hljs-keyword">this</span>.subs.push(sub);
            }
            notify() {
                <span class="hljs-keyword">this</span>.subs.forEach(<span class="hljs-function">(<span class="hljs-params">sub</span>) =&gt;</span> sub())
            }
        }
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">observe</span>(<span class="hljs-params">target</span>) </span>{
            <span class="hljs-built_in">Object</span>.keys(target).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
                <span class="hljs-keyword">let</span> val = target[key];
                <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> Dep();
                <span class="hljs-keyword">if</span> (key == <span class="hljs-string">'name'</span>) {
                    name.innerHTML = val;
                    dep.addSub(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> { name.innerHTML = val });
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key == <span class="hljs-string">'age'</span>) {
                    age.innerHTML = val;
                    dep.addSub(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> { age.innerHTML = val });
                }
                <span class="hljs-built_in">Object</span>.defineProperty(target, key, {
                    <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                        <span class="hljs-keyword">return</span> val;
                    },
                    <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{
                        val = value;
                        dep.notify();
                    }
                });
            })
        }

        <span class="hljs-keyword">let</span> obj = { <span class="hljs-attr">name</span>: <span class="hljs-string">'åç§°'</span>, <span class="hljs-attr">age</span>: <span class="hljs-string">'å¹´é¾„'</span> };
        observe(obj);
        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            obj.name = <span class="hljs-string">'æ–°åç§°'</span>;
        }, <span class="hljs-number">3000</span>);
        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            obj.age = <span class="hljs-string">'æ–°å¹´é¾„'</span>;
        }, <span class="hljs-number">6000</span>);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h5 id="t1149.3.9 redux">9.3.9 redux <a href="#t1149.3.9 redux"> # </a></h5>
<ul>
<li><a href="https://github.com/reduxjs/redux/blob/master/src/createStore.js">createStore</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createStore</span>(<span class="hljs-params">reducer,preloadedState,enhancer</span>) </span>{
    <span class="hljs-keyword">if</span> (enhancer) {
        <span class="hljs-keyword">return</span> enhancer(createStore)(reducer,preloadedState);
    }
    <span class="hljs-keyword">let</span> state=preloadedState;
    <span class="hljs-keyword">let</span> listeners=[];
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getState</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> state;
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subscribe</span>(<span class="hljs-params">listener</span>) </span>{
        listeners.push(listener);
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">const</span> index=listeners.indexOf(listener);
            listeners.splice(index,<span class="hljs-number">1</span>);
        }
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dispatch</span>(<span class="hljs-params">action</span>) </span>{
        state=reducer(state,action);
        listeners.forEach(<span class="hljs-function"><span class="hljs-params">listener</span>=&gt;</span>listener())
    }
    dispatch({<span class="hljs-attr">type</span>:<span class="hljs-string">'@@redux/INIT'</span>});
    <span class="hljs-keyword">return</span> {
        dispatch,
        subscribe,
        getState
    }
}
</code></pre>
<h4 id="t1159.4 å‘å¸ƒè®¢é˜…æ¨¡å¼">9.4 å‘å¸ƒè®¢é˜…æ¨¡å¼ <a href="#t1159.4 å‘å¸ƒè®¢é˜…æ¨¡å¼"> # </a></h4>
<h5 id="t1169.4.1 åŒºåˆ«">9.4.1 åŒºåˆ« <a href="#t1169.4.1 åŒºåˆ«"> # </a></h5>
<ul>
<li>è®¢é˜…è€…æŠŠè‡ªå·±æƒ³è®¢é˜…çš„äº‹ä»¶æ³¨å†Œåˆ°è°ƒåº¦ä¸­å¿ƒ</li>
<li>å½“è¯¥äº‹ä»¶è§¦å‘æ—¶å€™ï¼Œå‘å¸ƒè€…å‘å¸ƒè¯¥äº‹ä»¶åˆ°è°ƒåº¦ä¸­å¿ƒ,ç”±è°ƒåº¦ä¸­å¿ƒç»Ÿä¸€è°ƒåº¦è®¢é˜…è€…æ³¨å†Œåˆ°è°ƒåº¦ä¸­å¿ƒçš„å¤„ç†ä»£ç ã€‚</li>
<li>è™½ç„¶ä¸¤ç§æ¨¡å¼éƒ½å­˜åœ¨è®¢é˜…è€…å’Œå‘å¸ƒè€…ï¼ˆè§‚å¯Ÿè€…å¯è®¤ä¸ºæ˜¯è®¢é˜…è€…ã€è¢«è§‚å¯Ÿè€…å¯è®¤ä¸ºæ˜¯å‘å¸ƒè€…ï¼‰</li>
<li>ä½†æ˜¯è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ç”±è¢«è§‚å¯Ÿè€…è°ƒåº¦çš„ï¼Œè€Œå‘å¸ƒ/è®¢é˜…æ¨¡å¼æ˜¯ç»Ÿä¸€ç”±è°ƒåº¦ä¸­å¿ƒè°ƒçš„</li>
<li>æ‰€ä»¥è§‚å¯Ÿè€…æ¨¡å¼çš„è®¢é˜…è€…ä¸å‘å¸ƒè€…ä¹‹é—´æ˜¯å­˜åœ¨ä¾èµ–çš„ï¼Œè€Œå‘å¸ƒ/è®¢é˜…æ¨¡å¼åˆ™ä¸ä¼šã€‚</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/subscribepattern.jpg" alt="subscribepattern"></p>
<h5 id="t1179.4.2 ç±»å›¾">9.4.2 ç±»å›¾ <a href="#t1179.4.2 ç±»å›¾"> # </a></h5>
<p><img src="http://img.zhufengpeixun.cn/publishsubscribe.png" alt="publishsubscribe"></p>
<h5 id="t1189.4.3 ä»£ç ">9.4.3 ä»£ç  <a href="#t1189.4.3 ä»£ç "> # </a></h5>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Agency</span> </span>{
    _topics = {}
    subscribe(topic, listener) {
        <span class="hljs-keyword">let</span> listeners = <span class="hljs-keyword">this</span>._topics[topic];
        <span class="hljs-keyword">if</span> (listeners) {
            listeners.push(listener);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>._topics[topic] = [listener];
        }
    }
    publish(topic, ...args) {
        <span class="hljs-keyword">let</span> listeners = <span class="hljs-keyword">this</span>._topics[topic] || [];
        listeners.forEach(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> listener(...args));
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Landlord</span> </span>{
    <span class="hljs-keyword">constructor</span>(public agent: Agency) { }
    lend(topic, area, money) {
        <span class="hljs-keyword">this</span>.agent.publish(topic, area, money);
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Tenant</span> </span>{
    <span class="hljs-keyword">constructor</span>(public agent: Agency, public name: string) { }
    order(topic) {
        <span class="hljs-keyword">this</span>.agent.subscribe(topic, (area, money) =&gt; {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.name, <span class="hljs-string">`<span class="hljs-subst">${area}</span>å¹³ç±³, <span class="hljs-subst">${money}</span>å…ƒ`</span>);
        });
    }
}
<span class="hljs-keyword">let</span> agent = <span class="hljs-keyword">new</span> Agency();
<span class="hljs-keyword">let</span> rich = <span class="hljs-keyword">new</span> Tenant(agent, <span class="hljs-string">'å¤§æ¬¾'</span>);
<span class="hljs-keyword">let</span> poor = <span class="hljs-keyword">new</span> Tenant(agent, <span class="hljs-string">'åŒ—æ¼‚'</span>);
<span class="hljs-keyword">let</span> landlord = <span class="hljs-keyword">new</span> Landlord(agent);
rich.order(<span class="hljs-string">'è±ªå®…'</span>);
poor.order(<span class="hljs-string">'å•é—´'</span>);
landlord.lend(<span class="hljs-string">'è±ªå®…'</span>, <span class="hljs-number">10000</span>, <span class="hljs-number">1000000</span>);
landlord.lend(<span class="hljs-string">'å•é—´'</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1000</span>);
</code></pre>
<h5 id="t1199.4.4 Rediså‘å¸ƒè®¢é˜…">9.4.4 Rediså‘å¸ƒè®¢é˜… <a href="#t1199.4.4 Rediså‘å¸ƒè®¢é˜…"> # </a></h5>
<ul>
<li>Redis å‘å¸ƒè®¢é˜…æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼ï¼šå‘é€è€…å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…æ¥æ”¶æ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“ã€‚</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/redissubscribe.jpg" alt="redissubscribe"></p>
<p><img src="http://img.zhufengpeixun.cn/redispublishsubscribe.png" alt="redispublishsubscribe"></p>
<pre><code class="lang-js">SUBSCRIBE channel_a
PUBLISH channel_a zhufeng
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> redis = <span class="hljs-built_in">require</span>(<span class="hljs-string">'redis'</span>);
<span class="hljs-keyword">let</span> client1 = redis.createClient(<span class="hljs-number">6379</span>, <span class="hljs-string">'127.0.0.1'</span>);
<span class="hljs-keyword">let</span> client2 = redis.createClient(<span class="hljs-number">6379</span>, <span class="hljs-string">'127.0.0.1'</span>);

client1.subscribe(<span class="hljs-string">'channel_a'</span>);
client1.subscribe(<span class="hljs-string">'channel_b'</span>);
client1.on(<span class="hljs-string">'message'</span>, (channel, message) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'client1'</span>, channel, message);
    client1.unsubscribe(<span class="hljs-string">'channel_a'</span>);
});
client2.publish(<span class="hljs-string">'channel_a'</span>, <span class="hljs-string">'a_hello'</span>);
client2.publish(<span class="hljs-string">'channel_b'</span>, <span class="hljs-string">'b_hello'</span>);

setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    client2.publish(<span class="hljs-string">'channel_a'</span>, <span class="hljs-string">'a_world'</span>);
    client2.publish(<span class="hljs-string">'channel_b'</span>, <span class="hljs-string">'b_world'</span>);
}, <span class="hljs-number">3000</span>);
</code></pre>
<h2 id="t12010. å¤–è§‚æ¨¡å¼">10. å¤–è§‚æ¨¡å¼ <a href="#t12010. å¤–è§‚æ¨¡å¼"> # </a></h2>
<ul>
<li>å¤–è§‚æ¨¡å¼(Facade Pattern)åˆå«é—¨é¢æ¨¡å¼ï¼Œå®šä¹‰ä¸€ä¸ªå°†å­ç³»ç»Ÿçš„ä¸€ç»„æ¥å£é›†æˆåœ¨ä¸€èµ·çš„é«˜å±‚æ¥å£ï¼Œä»¥æä¾›ä¸€ä¸ªä¸€è‡´çš„å¤–è§‚</li>
<li>å¤–è§‚æ¨¡å¼è®©å¤–ç•Œå‡å°‘ä¸å­ç³»ç»Ÿå†…å¤šä¸ªæ¨¡å—çš„ç›´æ¥äº¤äº’ï¼Œä»è€Œå‡å°‘è€¦åˆï¼Œè®©å¤–ç•Œå¯ä»¥æ›´è½»æ¾åœ°ä½¿ç”¨å­ç³»ç»Ÿ</li>
<li>è¯¥è®¾è®¡æ¨¡å¼ç”±ä»¥ä¸‹è§’è‰²ç»„æˆ<ul>
<li>é—¨é¢è§’è‰²ï¼šå¤–è§‚æ¨¡å¼çš„æ ¸å¿ƒã€‚å®ƒè¢«å®¢æˆ·è§’è‰²è°ƒç”¨,å®ƒç†Ÿæ‚‰å­ç³»ç»Ÿçš„åŠŸèƒ½ã€‚å†…éƒ¨æ ¹æ®å®¢æˆ·è§’è‰²çš„éœ€æ±‚é¢„å®šäº†å‡ ç§åŠŸèƒ½çš„ç»„åˆ</li>
<li>å­ç³»ç»Ÿè§’è‰²:å®ç°äº†å­ç³»ç»Ÿçš„åŠŸèƒ½ã€‚å®ƒå¯¹å®¢æˆ·è§’è‰²å’Œ<code>Facade</code>æ˜¯æœªçŸ¥çš„</li>
<li>å®¢æˆ·è§’è‰²:é€šè¿‡è°ƒç”¨Facedeæ¥å®Œæˆè¦å®ç°çš„åŠŸèƒ½</li>
</ul>
</li>
<li>é¥æ§å™¨ã€è‡ªåŠ¨é©¾é©¶æ±½è½¦ã€æˆ¿å±‹ä¸­ä»‹</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/xiaomicontrol.jpg" alt="xiaomicontrol"></p>
<p><img src="http://img.zhufengpeixun.cn/facadepattern.jpeg" alt="facadepattern"></p>
<h4 id="t12110.1 è®¡ç®—å™¨">10.1 è®¡ç®—å™¨ <a href="#t12110.1 è®¡ç®—å™¨"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/facadepattern2.jpeg" alt="facadepattern2"></p>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sum</span> </span>{
    sum(a, b) {
        <span class="hljs-keyword">return</span> a + b;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Minus</span> </span>{
    minus(a, b) {
        <span class="hljs-keyword">return</span> a - b;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Multiply</span> </span>{
    multiply(a, b) {
        <span class="hljs-keyword">return</span> a * b;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Calculator</span> </span>{
    sumObj
    minusObj
    multiplyObj
    <span class="hljs-keyword">constructor</span>() {
        <span class="hljs-keyword">this</span>.sumObj = <span class="hljs-keyword">new</span> Sum();
        <span class="hljs-keyword">this</span>.minusObj = <span class="hljs-keyword">new</span> Minus();
        <span class="hljs-keyword">this</span>.multiplyObj = <span class="hljs-keyword">new</span> Multiply();
    }
    sum(...args) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.sumObj.sum(...args);
    }
    minus(...args) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.minusObj.minus(...args);
    }
    multiply(...args) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.multiplyObj.multiply(...args);
    }
}
<span class="hljs-keyword">let</span> calculator = <span class="hljs-keyword">new</span> Calculator();
<span class="hljs-built_in">console</span>.log(calculator.sum(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>));
<span class="hljs-built_in">console</span>.log(calculator.minus(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>));
<span class="hljs-built_in">console</span>.log(calculator.multiply(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>));
</code></pre>
<h4 id="t12210.2 è®¡ç®—æœº">10.2 è®¡ç®—æœº <a href="#t12210.2 è®¡ç®—æœº"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/computer2.jpg" alt="computer2"></p>
<pre><code class="lang-js">
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CPU</span> </span>{
    startup() { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æ‰“å¼€CPU'</span>); }
    shutdown() { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'å…³é—­CPU'</span>); }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Memory</span> </span>{
    startup() { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æ‰“å¼€å†…å­˜'</span>); }
    shutdown() { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'å…³é—­å†…å­˜'</span>); }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Disk</span> </span>{
    startup() { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'æ‰“å¼€ç¡¬ç›˜'</span>); }
    shutdown() { <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'å…³é—­ç¡¬ç›˜'</span>); }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Computer</span> </span>{
    cpu;
    memory;
    disk;
    <span class="hljs-keyword">constructor</span>() {
        <span class="hljs-keyword">this</span>.cpu = <span class="hljs-keyword">new</span> CPU();
        <span class="hljs-keyword">this</span>.memory = <span class="hljs-keyword">new</span> Memory();
        <span class="hljs-keyword">this</span>.disk = <span class="hljs-keyword">new</span> Disk();
    }
    startup() {
        <span class="hljs-keyword">this</span>.cpu.startup();
        <span class="hljs-keyword">this</span>.memory.startup();
        <span class="hljs-keyword">this</span>.disk.startup();
    }
    shutdown() {
        <span class="hljs-keyword">this</span>.cpu.shutdown();
        <span class="hljs-keyword">this</span>.memory.shutdown();
        <span class="hljs-keyword">this</span>.disk.shutdown();
    }
}
<span class="hljs-keyword">let</span> computer = <span class="hljs-keyword">new</span> Computer();
computer.startup();
computer.shutdown();
</code></pre>
<h4 id="t12310.3 å‹ç¼©">10.3 å‹ç¼© <a href="#t12310.3 å‹ç¼©"> # </a></h4>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> { }
<span class="hljs-keyword">var</span> zlib = <span class="hljs-built_in">require</span>(<span class="hljs-string">'zlib'</span>);
<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">let</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">open</span>(<span class="hljs-params">input</span>) </span>{
    <span class="hljs-keyword">let</span> ext = path.extname(input);
    <span class="hljs-keyword">switch</span> (ext) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'.gz'</span>:
            <span class="hljs-keyword">return</span> unZip(input);
        <span class="hljs-keyword">case</span> <span class="hljs-string">'.rar'</span>:
            <span class="hljs-keyword">return</span> unRar(input);
        <span class="hljs-keyword">case</span> <span class="hljs-string">'.7z'</span>:
            <span class="hljs-keyword">return</span> un7z(input);
        <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">break</span>;
    }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unZip</span>(<span class="hljs-params">src</span>) </span>{
    <span class="hljs-keyword">var</span> gunzip = zlib.createGunzip();
    <span class="hljs-keyword">var</span> inputStream = fs.createReadStream(src);
    <span class="hljs-keyword">var</span> outputStream = fs.createWriteStream(src.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-3</span>));
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'outputStream'</span>);

    inputStream.pipe(gunzip).pipe(outputStream);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unRar</span>(<span class="hljs-params">src</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Rarè§£å‹åçš„'</span>, src);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">un7z</span>(<span class="hljs-params">src</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'7zè§£å‹åçš„'</span>, src);
}
open(<span class="hljs-string">'./source.txt.gz'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">zip</span>(<span class="hljs-params">src</span>) </span>{
    <span class="hljs-keyword">var</span> gzip = zlib.createGzip();<span class="hljs-comment">//åˆ›å»ºå‹ç¼©æµ</span>
    <span class="hljs-keyword">var</span> inputStream = fs.createReadStream(src);
    <span class="hljs-keyword">var</span> outputStream = fs.createWriteStream(src+<span class="hljs-string">'.gz'</span>);
    inputStream.pipe(gzip).pipe(outputStream);
}
zip(<span class="hljs-string">'source.txt'</span>);
</code></pre>
<h4 id="t12410.4 redux">10.4 redux <a href="#t12410.4 redux"> # </a></h4>
<ul>
<li><a href="https://github.com/reduxjs/redux/blob/v4.0.0/src/index.js">redux index.js</a></li>
</ul>
<h4 id="t12510.5 å‡½æ•°é‡è½½">10.5 å‡½æ•°é‡è½½ <a href="#t12510.5 å‡½æ•°é‡è½½"> # </a></h4>
<ul>
<li>ä¸ºå¤æ‚çš„æ¨¡å—æˆ–å­ç³»ç»Ÿæä¾›å¤–ç•Œè®¿é—®çš„æ¨¡å—</li>
<li>å­ç³»ç»Ÿç›¸äº’ç‹¬ç«‹</li>
</ul>
<h5 id="t12610.5.1 å‚æ•°é‡è½½">10.5.1 å‚æ•°é‡è½½ <a href="#t12610.5.1 å‚æ•°é‡è½½"> # </a></h5>
<p>sum.ts</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sum</span>(<span class="hljs-params">a: number, b: string</span>);
<span class="hljs-title">function</span> <span class="hljs-title">sum</span>(<span class="hljs-params">a: string, b: number</span>);
<span class="hljs-title">function</span> <span class="hljs-title">sum</span>(<span class="hljs-params">a: any, b: any</span>) </span>{
    <span class="hljs-keyword">return</span> a + b;
}
</code></pre>
<h5 id="t12710.5.2 react createElement">10.5.2 react createElement <a href="#t12710.5.2 react createElement"> # </a></h5>
<p>-<a href="https://github.com/facebook/react/blob/master/packages/react/src/ReactElement.js#L347-L361">react create-element</a></p>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createElement</span> (<span class="hljs-params">
  context: Component,
  tag: any,
  data: any,
  children: any,
  normalizationType: any,
  alwaysNormalize: boolean
</span>): <span class="hljs-title">VNode</span> | <span class="hljs-title">Array</span>&lt;<span class="hljs-title">VNode</span>&gt; </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(data) || isPrimitive(data)) {
    normalizationType = children
    children = data
    data = <span class="hljs-literal">undefined</span>
  }
  <span class="hljs-keyword">if</span> (isTrue(alwaysNormalize)) {
    normalizationType = ALWAYS_NORMALIZE
  }
  <span class="hljs-keyword">return</span> _createElement(context, tag, data, children, normalizationType)
}
</code></pre>
<h5 id="t12810.5.3 vue createElement">10.5.3 vue createElement <a href="#t12810.5.3 vue createElement"> # </a></h5>
<p>-<a href="https://github.com/vuejs/vue/blob/v2.6.10/src/core/vdom/create-element.js#L28-L45">vue create-element</a></p>
<pre><code class="lang-js">  <span class="hljs-keyword">const</span> childrenLength = <span class="hljs-built_in">arguments</span>.length - <span class="hljs-number">2</span>;
  <span class="hljs-keyword">if</span> (childrenLength === <span class="hljs-number">1</span>) {
    props.children = children;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (childrenLength &gt; <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">const</span> childArray = <span class="hljs-built_in">Array</span>(childrenLength);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; childrenLength; i++) {
      childArray[i] = <span class="hljs-built_in">arguments</span>[i + <span class="hljs-number">2</span>];
    }
    <span class="hljs-keyword">if</span> (__DEV__) {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.freeze) {
        <span class="hljs-built_in">Object</span>.freeze(childArray);
      }
    }
    props.children = childArray;
  }
</code></pre>
<h5 id="t12910.5.4 buffer">10.5.4 buffer <a href="#t12910.5.4 buffer"> # </a></h5>
<p><a href="https://github.com/nodejs/node/blob/master/lib/buffer.js#L1082">buffer.js</a></p>
<pre><code class="lang-js">Buffer.prototype.slice = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">slice</span>(<span class="hljs-params">start, end</span>) </span>{
  <span class="hljs-keyword">const</span> srcLength = <span class="hljs-keyword">this</span>.length;
  end = end !== <span class="hljs-literal">undefined</span> ? srcLength: srcLength;
  <span class="hljs-keyword">const</span> newLength = end &gt; start ? end - start : <span class="hljs-number">0</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> FastBuffer(<span class="hljs-keyword">this</span>.buffer, <span class="hljs-keyword">this</span>.byteOffset + start, newLength);
};
</code></pre>
<h5 id="t13010.5.5 createStore">10.5.5 createStore <a href="#t13010.5.5 createStore"> # </a></h5>
<ul>
<li><a href="https://github.com/reduxjs/redux/blob/e95eaf2dc2024fe99dc0f7334a8bd049b4949ed0/src/createStore.js#L31-L35">createStore</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createStore</span>(<span class="hljs-params">reducer, preloadedState, enhancer</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> preloadedState === <span class="hljs-string">'function'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> enhancer === <span class="hljs-string">'undefined'</span>) {
    enhancer = preloadedState
    preloadedState = <span class="hljs-literal">undefined</span>
  }
}
</code></pre>
<h5 id="t13110.5.6 axios">10.5.6 axios <a href="#t13110.5.6 axios"> # </a></h5>
<ul>
<li><a href="https://github.com/axios/axios/blob/v0.19.0/lib/defaults.js#L16-L27">defaults</a></li>
</ul>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDefaultAdapter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> adapter;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> process !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.prototype.toString.call(process) === <span class="hljs-string">'[object process]'</span>) {
    adapter = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./adapters/http'</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> XMLHttpRequest !== <span class="hljs-string">'undefined'</span>) {
    adapter = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./adapters/xhr'</span>);
  }
  <span class="hljs-keyword">return</span> adapter;
}
</code></pre>
<h5 id="t13210.5.7 polyfill">10.5.7 polyfill <a href="#t13210.5.7 polyfill"> # </a></h5>
<ul>
<li>polyfillå¯ä»¥è®©æˆ‘ä»¬å¤„ç†æµè§ˆå™¨å…¼å®¹å’Œå±è”½äº†æµè§ˆå™¨å·®å¼‚</li>
<li><a href="https://github.com/jquery/jquery/blob/1.5/src/event.js#L584-L596">removeEvent</a></li>
</ul>
<pre><code class="lang-js">jQuery.removeEvent = <span class="hljs-built_in">document</span>.removeEventListener ?
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> elem, type, handle </span>) </span>{
        <span class="hljs-keyword">if</span> ( elem.removeEventListener ) {
            elem.removeEventListener( type, handle, <span class="hljs-literal">false</span> );
        }
    } :
    <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"> elem, type, handle </span>) </span>{
        <span class="hljs-keyword">if</span> ( elem.detachEvent ) {
            elem.detachEvent( <span class="hljs-string">"on"</span> + type, handle );
        }
    };
</code></pre>
<h2 id="t13311. è¿­ä»£å™¨æ¨¡å¼">11. è¿­ä»£å™¨æ¨¡å¼ <a href="#t13311. è¿­ä»£å™¨æ¨¡å¼"> # </a></h2>
<ul>
<li>è¿­ä»£å™¨æ¨¡å¼(Iterator Pattern)ç”¨äºé¡ºåºåœ°è®¿é—®èšåˆå¯¹è±¡å†…éƒ¨çš„å…ƒç´ ï¼Œåˆæ— éœ€çŸ¥é“å¯¹è±¡å†…éƒ¨ç»“æ„ã€‚ä½¿ç”¨äº†è¿­ä»£å™¨ä¹‹åï¼Œä½¿ç”¨è€…ä¸éœ€è¦å…³å¿ƒå¯¹è±¡çš„å†…éƒ¨æ„é€ ï¼Œå°±å¯ä»¥æŒ‰åºè®¿é—®å…¶ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚</li>
</ul>
<h3 id="t13411.1 ç±»å›¾">11.1 ç±»å›¾ <a href="#t13411.1 ç±»å›¾"> # </a></h3>
<p><img src="http://img.zhufengpeixun.cn/iteratorpattern.jpeg" alt="iterator"></p>
<h3 id="t13511.2 ä»£ç ">11.2 ä»£ç  <a href="#t13511.2 ä»£ç "> # </a></h3>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createIterator</span>(<span class="hljs-params">arr</span>) </span>{
    <span class="hljs-keyword">let</span> index=<span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> {
        next() {
            <span class="hljs-keyword">return</span> index&lt;arr.length?
                {<span class="hljs-attr">value</span>: arr[index++],<span class="hljs-attr">done</span>: <span class="hljs-literal">false</span>}:
                {<span class="hljs-attr">done</span>:<span class="hljs-literal">true</span>}
        }
    }
}
<span class="hljs-keyword">let</span> it=createIterator([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]);
<span class="hljs-built_in">console</span>.log(it.next());
<span class="hljs-built_in">console</span>.log(it.next());
<span class="hljs-built_in">console</span>.log(it.next());
</code></pre>
<h3 id="t13611.3 åœºæ™¯">11.3 åœºæ™¯ <a href="#t13611.3 åœºæ™¯"> # </a></h3>
<h4 id="t13711.3.1 forEach">11.3.1 forEach <a href="#t13711.3.1 forEach"> # </a></h4>
<ul>
<li>å¯ä»¥ä½¿ç”¨ for å¾ªç¯è‡ªå·±å®ç°ä¸€ä¸ª <code>forEach</code><pre><code class="lang-js"><span class="hljs-built_in">Array</span>.prototype.forEach = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cb</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.length; i++) {
      cb.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>[i], i, arr);
  }
}
<span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
arr.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(item);
});
</code></pre>
</li>
</ul>
<h4 id="t13811.3.2 each">11.3.2 each <a href="#t13811.3.2 each"> # </a></h4>
<ul>
<li><a href="https://github.com/jquery/jquery/blob/3.4.1/src/core.js#L246-L265">jquery</a></li>
<li><a href="https://github.com/jashkenas/underscore/blob/1.9.1/underscore.js#L181-L195">underscore</a></li>
</ul>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"http://libs.baidu.com/jquery/2.0.0/jquery.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">

    $.each([<span class="hljs-string">'1'</span>, <span class="hljs-string">'2'</span>, <span class="hljs-string">'3'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index, item</span>) </span>{
        <span class="hljs-built_in">console</span>.log(index, item);
    })
    $.each({ <span class="hljs-attr">name</span>: <span class="hljs-string">'zhufeng'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">10</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index, item</span>) </span>{
        <span class="hljs-built_in">console</span>.log(index, item);
    })
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">each</span>(<span class="hljs-params">obj, callback</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(obj)) {
            <span class="hljs-keyword">let</span> length = obj.length;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) {
                <span class="hljs-keyword">if</span> (callback.call(obj[i], i, obj[i]) === <span class="hljs-literal">false</span>) {
                    <span class="hljs-keyword">break</span>;
                }
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i <span class="hljs-keyword">in</span> obj) {
                <span class="hljs-keyword">if</span> (callback.call(obj[i], i, obj[i]) === <span class="hljs-literal">false</span>) {
                    <span class="hljs-keyword">break</span>;
                }
            }
        }

        <span class="hljs-keyword">return</span> obj;
    }

    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
</code></pre>
<h4 id="t13911.3.3 Iterator">11.3.3 Iterator <a href="#t13911.3.3 Iterator"> # </a></h4>
<ul>
<li>åœ¨ES6ä¸­æœ‰åºé›†åˆæ•°æ®ç±»å‹æœ‰Arrayã€Mapã€Setã€Stringã€TypedArrayã€argumentsã€NodeList</li>
<li>æˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªç»Ÿä¸€çš„éå†æ¥å£æ¥éå†æ‰€æœ‰çš„æ•°æ®ç±»å‹</li>
<li>ä»–ä»¬éƒ½æœ‰ [Symbol.Iterator]å±æ€§ï¼Œå±æ€§æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œå‡½æ•°ä¼šè¿”å›è¿­ä»£å™¨</li>
<li>è¿­ä»£å™¨å°±æœ‰<code>next</code>æ–¹æ³•é¡ºåºè¿”å›å­å…ƒç´ </li>
</ul>
<pre><code class="lang-js"><span class="hljs-built_in">Array</span>[<span class="hljs-built_in">Symbol</span>.iterator] = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-keyword">return</span> index &lt; <span class="hljs-keyword">this</span>.length ?
                { <span class="hljs-attr">value</span>: <span class="hljs-keyword">this</span>[index++], <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span> } :
                { <span class="hljs-attr">done</span>: <span class="hljs-literal">true</span> }
        }
    }
}
<span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>];
<span class="hljs-keyword">let</span> it = arr[<span class="hljs-built_in">Symbol</span>.iterator]();
<span class="hljs-built_in">console</span>.log(it.next());
<span class="hljs-built_in">console</span>.log(it.next());
<span class="hljs-built_in">console</span>.log(it.next());
</code></pre>
<h4 id="t14011.3.4 yield*">11.3.4 yield* <a href="#t14011.3.4 yield*"> # </a></h4>
<ul>
<li>yield*åé¢è·Ÿçš„æ˜¯ä¸€ä¸ªå¯éå†çš„ç»“æ„ï¼Œå®ƒä¼šè°ƒç”¨è¯¥ç»“æ„çš„éå†å™¨æ¥å£</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> generator = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">yield</span>* [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
    <span class="hljs-keyword">yield</span> <span class="hljs-number">4</span>;
};

<span class="hljs-keyword">var</span> iterator = generator();

<span class="hljs-built_in">console</span>.log(iterator.next()); <span class="hljs-comment">// { value: 1, done: false }</span>
<span class="hljs-built_in">console</span>.log(iterator.next()); <span class="hljs-comment">// { value: 2, done: false }</span>
<span class="hljs-built_in">console</span>.log(iterator.next()); <span class="hljs-comment">// { value: 3, done: false }</span>
<span class="hljs-built_in">console</span>.log(iterator.next()); <span class="hljs-comment">// { value: 4, done: false }</span>
<span class="hljs-built_in">console</span>.log(iterator.next()); <span class="hljs-comment">// { value: undefined, done: true }</span>
</code></pre>
<h4 id="t14111.3.5 äºŒå‰æ ‘éå†">11.3.5 äºŒå‰æ ‘éå† <a href="#t14111.3.5 äºŒå‰æ ‘éå†"> # </a></h4>
<ul>
<li>äºŒå‰æ ‘æ˜¯æ¯ä¸ªç»“ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªå­æ ‘çš„æ ‘ç»“æ„ã€‚é€šå¸¸å­æ ‘è¢«ç§°ä½œå·¦å­æ ‘å’Œå³å­æ ‘</li>
<li>æ ¹æ®æ ¹æ®æ ¹èŠ‚ç‚¹çš„é¡ºåºå¯ä»¥æŠŠéå†åˆ†ä¸ºä¸‰ç§å‰åºã€ä¸­åºã€ååº<ul>
<li>å…ˆåºéå†ï¼šæ ¹èŠ‚ç‚¹-&gt;å·¦å­æ ‘-&gt;å³å­æ ‘</li>
<li>ä¸­åºéå†ï¼šå·¦å­æ ‘-&gt;æ ¹èŠ‚ç‚¹-&gt;å³å­æ ‘</li>
<li>ååºéå†ï¼šå·¦å­æ ‘-&gt;å³å­æ ‘-&gt;æ ¹èŠ‚ç‚¹</li>
</ul>
</li>
</ul>
<p><img src="http://img.zhufengpeixun.cn/varorder.png" alt="varorder"></p>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Tree</span> </span>{
    <span class="hljs-keyword">constructor</span>(public left, public value, public right) {
    }
}
<span class="hljs-comment">//['A', 'B', 'D','E', 'C', 'F','G']</span>
<span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">leftOrder</span>(<span class="hljs-params">tree</span>) </span>{
    <span class="hljs-keyword">if</span> (tree) {
        <span class="hljs-keyword">yield</span> tree.value;
        <span class="hljs-keyword">yield</span>* leftOrder(tree.left);
        <span class="hljs-keyword">yield</span>* leftOrder(tree.right);
    }
}

<span class="hljs-comment">//['D', 'B', 'E','A', 'F', 'C','G']</span>
<span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">inOrder</span>(<span class="hljs-params">tree</span>) </span>{
    <span class="hljs-keyword">if</span> (tree) {
        <span class="hljs-keyword">yield</span>* inOrder(tree.left);
        <span class="hljs-keyword">yield</span> tree.value;
        <span class="hljs-keyword">yield</span>* inOrder(tree.right);
    }
}
<span class="hljs-comment">//['D', 'E', 'B','F', 'G', 'C','A']</span>
<span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">rightOrder</span>(<span class="hljs-params">tree</span>) </span>{
    <span class="hljs-keyword">if</span> (tree) {
        <span class="hljs-keyword">yield</span>* rightOrder(tree.left);
        <span class="hljs-keyword">yield</span>* rightOrder(tree.right);
        <span class="hljs-keyword">yield</span> tree.value;
    }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">make</span>(<span class="hljs-params">array</span>) </span>{
    <span class="hljs-keyword">if</span> (array.length === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tree(<span class="hljs-literal">null</span>, array[<span class="hljs-number">0</span>], <span class="hljs-literal">null</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Tree(make(array[<span class="hljs-number">0</span>]), array[<span class="hljs-number">1</span>], make(array[<span class="hljs-number">2</span>]));
}
<span class="hljs-keyword">let</span> tree = make([[[<span class="hljs-string">'D'</span>], <span class="hljs-string">'B'</span>, [<span class="hljs-string">'E'</span>]], <span class="hljs-string">'A'</span>, [[<span class="hljs-string">'F'</span>], <span class="hljs-string">'C'</span>, [<span class="hljs-string">'G'</span>]]]);
<span class="hljs-keyword">var</span> result: any[] = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> node <span class="hljs-keyword">of</span> rightOrder(tree)) {
    result.push(node);
}
<span class="hljs-built_in">console</span>.log(result);
</code></pre>
<blockquote>
<p> "downlevelIteration": true, /<em> Provide full support for iterables in 'for-of', spread, and destructuring when targeting 'ES5' or 'ES3'. </em>/</p>
</blockquote>

    